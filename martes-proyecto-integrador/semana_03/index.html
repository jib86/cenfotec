<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clase 3: Anatom√≠a del Dataset Olist - SINT-201</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Lato:wght@300;400;700;900&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            /* Base Colors */
            --bg-dark: #0f172a;
            --bg-darker: #020617;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;

            /* Accents */
            --primary: #0ea5e9;
            /* Sky Blue */
            --secondary: #8b5cf6;
            /* Violet */
            --accent: #22d3ee;
            /* Cyan */
            --rose: #f43f5e;
            /* Rose for errors/attention */
            --emerald: #10b981;
            /* Green for success */
            --amber: #f59e0b;
            /* Amber for warnings */

            /* Glassmorphism */
            --glass-bg: rgba(30, 41, 59, 0.4);
            --glass-border: rgba(255, 255, 255, 0.1);

            /* Code */
            --code-bg: #1e1e2e;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: var(--bg-dark);
            background-image:
                radial-gradient(circle at 15% 50%, rgba(139, 92, 246, 0.1), transparent 25%),
                radial-gradient(circle at 85% 30%, rgba(14, 165, 233, 0.1), transparent 25%),
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .slides-container {
            flex: 1;
            width: 100%;
            position: relative;
            overflow: hidden;
            perspective: 1000px;
        }

        .slide {
            position: absolute;
            inset: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transform: scale(0.9) translateY(30px);
            transition: opacity 0.5s ease, transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            pointer-events: none;
            padding: 2rem;
        }

        .slide.active {
            opacity: 1;
            transform: scale(1) translateY(0);
            pointer-events: all;
            z-index: 10;
        }

        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(24px) saturate(180%);
            -webkit-backdrop-filter: blur(24px) saturate(180%);
            border: 1px solid var(--glass-border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), inset 0 0 20px rgba(255, 255, 255, 0.02);
            border-radius: 32px;
            padding: 2.5rem;
            width: 100%;
            max-width: 1400px;
            height: 90vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-family: 'Lato', sans-serif;
            font-weight: 900;
            font-size: 4rem;
            line-height: 1.1;
            margin-bottom: 2rem;
            letter-spacing: -0.02em;
            background: linear-gradient(to right, #ffffff 30%, #94a3b8);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        h2 {
            font-family: 'Lato', sans-serif;
            font-weight: 800;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #fff;
            display: inline-flex;
            align-items: center;
            gap: 1rem;
        }

        h3 {
            font-size: 1.3rem;
            color: #fff;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        p,
        li {
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        strong {
            color: var(--text-main);
            font-weight: 600;
        }

        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 99px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
            background: rgba(14, 165, 233, 0.2);
            color: var(--primary);
            border: 1px solid rgba(14, 165, 233, 0.3);
        }

        /* Grids */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            height: 100%;
        }

        .bento-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            height: 100%;
            flex: 1;
        }

        .bento-box {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: transform 0.3s ease;
        }

        .bento-box:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary);
        }

        /* Spiderweb Visualization */
        .spider-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .node {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            z-index: 2;
        }

        .node:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .node-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(30, 41, 59, 0.9);
            border: 2px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 0.5rem;
        }

        .node-label {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--text-muted);
        }

        .node.center .node-circle {
            width: 140px;
            height: 140px;
            border-color: var(--primary);
            background: rgba(14, 165, 233, 0.1);
            box-shadow: 0 0 40px rgba(14, 165, 233, 0.3);
            color: var(--primary);
            font-size: 2.5rem;
        }

        .line {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            height: 2px;
            transform-origin: left center;
            z-index: 1;
        }

        /* Timeline Horizontal */
        .timeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            margin: 3rem 0;
            padding: 0 1rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 1rem;
            right: 1rem;
            top: 10px;
            height: 2px;
            background: rgba(255, 255, 255, 0.2);
            z-index: 0;
        }

        .time-point {
            position: relative;
            z-index: 2;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 18%;
        }

        .time-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--bg-dark);
            border: 3px solid var(--text-muted);
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .time-point.active .time-dot {
            border-color: var(--emerald);
            background: var(--emerald);
            box-shadow: 0 0 15px var(--emerald);
        }

        .time-point.warning .time-dot {
            border-color: var(--amber);
            background: var(--amber);
            box-shadow: 0 0 15px var(--amber);
        }

        .time-label {
            font-size: 0.95rem;
            color: #fff;
            font-weight: bold;
            display: block;
            margin-bottom: 0.25rem;
        }

        .time-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
            display: block;
            line-height: 1.3;
        }

        /* Join Flow Vertical */
        .join-step {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            margin-bottom: 1rem;
        }

        .join-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.95);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background: #1e293b;
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 4rem;
            width: 90%;
            max-width: 1000px;
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 1.5rem;
            right: 2rem;
            background: transparent;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
        }

        #progressBar {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            z-index: 200;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            width: 0%;
            transition: width 0.4s ease;
        }

        .explanation-text {
            font-size: 1.1rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
        }

        /* Explicit Tooltips */
        .term {
            border-bottom: 2px dashed rgba(34, 211, 238, 0.4);
            cursor: help;
            position: relative;
            transition: all 0.2s;
        }

        .term:hover {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }

        .term:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(15, 23, 42, 0.95);
            color: #fff;
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            width: max-content;
            max-width: 300px;
            white-space: normal;
            font-size: 0.9rem;
            border: 1px solid var(--accent);
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            line-height: 1.4;
            text-align: center;
        }
    </style>
</head>

<body>
    <div id="progressBar"></div>

    <div class="slides-container">

        <!-- SLIDE 1: Title -->
        <div class="slide active">
            <div class="card" style="text-align: center; justify-content: center; align-items: center;">
                <span class="tag">SINT-201 &bull; Clase 3 &bull; Data Engineering <span class="term"
                        data-tooltip="Ingenier√≠a de Datos: La disciplina de dise√±ar y construir sistemas para recolectar y usar datos.">(?)</span></span>
                <h1>Anatom√≠a del Dataset Olist</h1>
                <p style="max-width: 900px; margin: 0 auto 3rem auto; font-size: 1.5rem; color: #e2e8f0;">
                    Vamos a construir el "Plano Maestro" del E-commerce.
                </p>

                <div
                    style="max-width: 800px; text-align: left; background: rgba(255,255,255,0.03); padding: 2rem; border-radius: 20px;">
                    <p style="margin-bottom: 0.5rem;"><strong style="color: var(--primary);">üë©‚Äçüè´ Mensaje para la
                            Clase:</strong></p>
                    <p>
                        "Olviden la idea de abrir un solo archivo Excel con todas las respuestas.
                        Este <span class="term"
                            data-tooltip="Dataset: Conjunto de datos estructurados, generalmente en tablas.">dataset</span>
                        es una <strong>Base de Datos Relacional</strong> real. Tienen 9 tablas separadas.
                        Si no entienden c√≥mo se conectan (qui√©n compr√≥ qu√©, cu√°ndo y d√≥nde), sus an√°lisis estar√°n
                        fundamentalmente equivocados."
                    </p>
                </div>
            </div>
        </div>

        <!-- SLIDE 2: The Mental Map (Official Schema) -->
        <div class="slide">
            <div class="card">
                <h2>El Esquema Relacional <span style="font-size: 0.6em; opacity: 0.7;">(ERD: Entity Relationship
                        Diagram)</span></h2>

                <style>
                    /* Icon Node CSS */
                    .icon-node {
                        position: absolute;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        cursor: pointer;
                        transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
                        z-index: 10;
                    }

                    .icon-circle {
                        width: 90px;
                        height: 90px;
                        border-radius: 50%;
                        background: var(--node-bg);
                        border: 3px solid var(--node-border);
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        font-size: 2.2rem;
                        color: #fff;
                        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5), 0 0 0 4px rgba(255, 255, 255, 0.05);
                        position: relative;
                        overflow: hidden;
                    }

                    /* Shiny effect */
                    .icon-circle::after {
                        content: '';
                        position: absolute;
                        top: -50%;
                        left: -50%;
                        width: 200%;
                        height: 200%;
                        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
                        transform: rotate(45deg);
                    }

                    .node-label {
                        margin-top: 12px;
                        background: rgba(15, 23, 42, 0.9);
                        padding: 4px 12px;
                        border-radius: 99px;
                        font-family: 'Fira Code', monospace;
                        font-size: 0.85rem;
                        color: var(--text-muted);
                        border: 1px solid rgba(255, 255, 255, 0.1);
                        white-space: nowrap;
                    }

                    .icon-node:hover {
                        transform: scale(1.15) translateY(-5px);
                        z-index: 20;
                    }

                    .icon-node:hover .node-label {
                        color: #fff;
                        border-color: var(--node-border);
                    }

                    /* Colors based on Kaggle Diagram */
                    .node-orders {
                        --node-bg: linear-gradient(135deg, #e11d48, #be123c);
                        --node-border: #f43f5e;
                    }

                    .node-items {
                        --node-bg: linear-gradient(135deg, #ea580c, #c2410c);
                        --node-border: #f97316;
                    }

                    .node-products {
                        --node-bg: linear-gradient(135deg, #ca8a04, #a16207);
                        --node-border: #eab308;
                    }

                    .node-customers {
                        --node-bg: linear-gradient(135deg, #0d9488, #0f766e);
                        --node-border: #14b8a6;
                    }

                    .node-geo {
                        --node-bg: linear-gradient(135deg, #2563eb, #1d4ed8);
                        --node-border: #3b82f6;
                    }

                    .node-payments {
                        --node-bg: linear-gradient(135deg, #475569, #334155);
                        --node-border: #94a3b8;
                    }

                    .node-reviews {
                        --node-bg: linear-gradient(135deg, #9333ea, #7e22ce);
                        --node-border: #a855f7;
                    }

                    .node-sellers {
                        --node-bg: linear-gradient(135deg, #059669, #047857);
                        --node-border: #10b981;
                    }

                    /* Arrow Labels */
                    .conn-label {
                        position: absolute;
                        font-family: 'Fira Code', monospace;
                        font-size: 0.7rem;
                        color: #94a3b8;
                        background: #0f172a;
                        padding: 2px 6px;
                        border-radius: 4px;
                        border: 1px solid rgba(255, 255, 255, 0.1);
                        transform: translate(-50%, -50%);
                        z-index: 5;
                    }
                </style>

                <div style="flex: 1; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; overflow: hidden;"
                    id="erd-container">
                    <img src="https://i.imgur.com/HRhd2Y0.png" alt="Olist Relational Schema"
                        style="max-width: 85%; max-height: 72vh; object-fit: contain; border-radius: 12px; box-shadow: 0 20px 50px rgba(0,0,0,0.5);">

                </div>
            </div>
        </div>

        <!-- SLIDE 2.5: SQL Commands Toolkit -->
        <div class="slide">
            <div class="card" style="display: flex; flex-direction: column;">
                <h2><i class="fa-brands fa-python"></i> Comandos Python/Pandas</h2>
                <p style="font-size: 0.95rem; margin-bottom: 1.5rem; opacity: 0.9;">
                    <strong><span class="term"
                            data-tooltip="pandas: Biblioteca de software escrita para el lenguaje Python para manipulaci√≥n y an√°lisis de datos.">pandas</span></strong>
                    es la biblioteca de Python.
                    <span style="opacity: 0.7;">Haz click en cada comando para ver ejemplos detallados:</span>
                </p>

                <!-- Asymmetric Grid of Commands -->
                <div style="display: grid; 
                            grid-template-columns: 1.2fr 1fr 1fr 1fr; 
                            grid-template-rows: auto auto; 
                            gap: 1rem; 
                            flex: 1;
                            grid-template-areas: 
                                'select filter filter merge'
                                'groupby sort head merge';">

                    <!-- SELECT columns -->
                    <div class="bento-box" onclick="openPandasModal('select')"
                        style="border-left: 4px solid var(--primary); cursor: pointer; transition: transform 0.2s; padding: 1.2rem; position: relative; min-height: 120px;"
                        onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <h3 style="color: var(--primary); margin-bottom: 0.5rem; font-size: 1.2rem;">
                            <code>[[columnas]]</code>
                        </h3>
                        <p style="font-size: 0.95rem; opacity: 0.85; margin: 0;">Seleccionar columnas</p>
                        <i class="fa-solid fa-circle-info"
                            style="position: absolute; top: 0.7rem; right: 0.7rem; font-size: 0.85rem; opacity: 0.5;"></i>
                    </div>

                    <!-- WHERE / Filter -->
                    <div class="bento-box" onclick="openPandasModal('filter')"
                        style="grid-area: filter; border-left: 4px solid var(--amber); cursor: pointer; transition: transform 0.2s; padding: 1.2rem; position: relative;"
                        onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <h3 style="color: var(--amber); margin-bottom: 0.5rem;"><code>df[condici√≥n]</code></h3>
                        <p style="font-size: 0.9rem; margin-bottom: 0.8rem; opacity: 0.9;">
                            <strong>Qu√© hace:</strong> Filtra filas <span
                                style="font-size: 0.8em; opacity: 0.7;">(Similar a <strong>WHERE</strong> en SQL)</span>
                        </p>
                        <pre
                            style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; font-size: 0.85rem; overflow-x: auto;">orders[orders['order_status'] == 'delivered']</pre>
                        <p style="font-size: 0.8rem; margin-top: 0.5rem; opacity: 0.7;">
                            üìå Usa == para igualdad, != para diferente, >, <, etc. </p>
                    </div>

                    <!-- JOIN / Merge -->
                    <div class="bento-box" onclick="openPandasModal('merge')"
                        style="grid-area: merge; border-left: 4px solid var(--emerald); cursor: pointer; transition: transform 0.2s; padding: 1.2rem; position: relative;"
                        onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <h3 style="color: var(--emerald); margin-bottom: 0.5rem; font-size: 1.2rem;">
                            <code>pd.merge()</code>
                        </h3>
                        <p style="font-size: 0.95rem; opacity: 0.85; margin: 0;">Unir tablas</p>
                        <i class="fa-solid fa-circle-info"
                            style="position: absolute; top: 0.7rem; right: 0.7rem; font-size: 0.85rem; opacity: 0.5;"></i>
                    </div>

                    <!-- GROUP BY -->
                    <div class="bento-box" onclick="openPandasModal('groupby')"
                        style="grid-area: groupby; border-left: 4px solid var(--secondary); cursor: pointer; transition: transform 0.2s; padding: 1.2rem; position: relative;"
                        onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <h3 style="color: var(--secondary); margin-bottom: 0.5rem; font-size: 1.2rem;">
                            <code>.groupby()</code>
                        </h3>
                        <p style="font-size: 0.95rem; opacity: 0.85; margin: 0;">Agrupar datos</p>
                        <i class="fa-solid fa-circle-info"
                            style="position: absolute; top: 0.7rem; right: 0.7rem; font-size: 0.85rem; opacity: 0.5;"></i>
                    </div>

                    <!-- ORDER BY / Sort -->
                    <div class="bento-box" onclick="openPandasModal('sort')"
                        style="grid-area: sort; border-left: 4px solid var(--rose); cursor: pointer; transition: transform 0.2s; padding: 1.2rem; position: relative;"
                        onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <h3 style="color: var(--rose); margin-bottom: 0.5rem; font-size: 1.2rem;">
                            <code>.sort_values()</code>
                        </h3>
                        <p style="font-size: 0.95rem; opacity: 0.85; margin: 0;">Ordenar</p>
                        <i class="fa-solid fa-circle-info"
                            style="position: absolute; top: 0.7rem; right: 0.7rem; font-size: 0.85rem; opacity: 0.5;"></i>
                    </div>

                    <!-- LIMIT / Head -->
                    <div class="bento-box" onclick="openPandasModal('head')"
                        style="grid-area: head; border-left: 4px solid #06b6d4; cursor: pointer; transition: transform 0.2s; padding: 1.2rem; position: relative;"
                        onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                        <h3 style="color: #06b6d4; margin-bottom: 0.5rem; font-size: 1.2rem;">
                            <code>.head(n)</code>
                        </h3>
                        <p style="font-size: 0.95rem; opacity: 0.85; margin: 0;">Primeras N filas</p>
                        <i class="fa-solid fa-circle-info"
                            style="position: absolute; top: 0.7rem; right: 0.7rem; font-size: 0.85rem; opacity: 0.5;"></i>
                    </div>

                </div>

                <!-- Footer Note -->
                <div
                    style="margin-top: 1.5rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-radius: 8px; border-left: 4px solid var(--primary);">
                    <strong style="color: var(--primary);">ÔøΩ Lenguaje del Curso:</strong>
                    <p style="margin-top: 0.5rem; font-size: 0.95rem;">
                        Estos comandos pertenecen a <strong>Python</strong> usando la biblioteca
                        <strong>pandas</strong>.
                        Pandas es el est√°ndar de la industria para an√°lisis de datos en Python. Primero debes importar:
                        <code
                            style="background: rgba(0,0,0,0.3); padding: 0.2rem 0.5rem; border-radius: 4px;">import pandas as pd</code>
                    </p>
                </div>
            </div>
        </div>

        <!-- SLIDE 3: Orders Deep Dive -->
        <div class="slide">
            <div class="card">
                <h2>La Tabla Madre: <code style="color: var(--primary);">olist_orders</code></h2>

                <!-- Asymmetric Layout: Concepts (Left) vs Analysis (Right) -->
                <div class="grid-asymmetric"
                    style="display: grid; grid-template-columns: 0.8fr 1.2fr; gap: 1.5rem; height: 100%; align-content: start; margin-top: 1rem;">

                    <!-- LEFT COLUMN: Concepts & Rules -->
                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">

                        <!-- 1. Definition -->
                        <div class="bento-box" onclick="openConceptModal('bitacora')"
                            style="cursor: pointer; transition: transform 0.2s;"
                            onmouseover="this.style.transform='scale(1.02)'"
                            onmouseout="this.style.transform='scale(1)'">
                            <h3 style="color: var(--primary); margin-bottom: 0.5rem;">Bit√°cora del Sistema <i
                                    class="fa-solid fa-circle-info"
                                    style="font-size: 0.8rem; opacity: 0.5; margin-left: 0.5rem;"></i></h3>
                            <p>Cada fila es un pedido √∫nico <span class="term"
                                    data-tooltip="Cada fila representa una transacci√≥n individual. No hay duplicados de ID.">(PK)</span>.
                            </p>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.8;">Solo sabe que "Alguien"
                                pidi√≥ "Algo" en tal "Fecha" <span class="term"
                                    data-tooltip="Timestamp: Marca de tiempo que incluye Fecha y Hora exacta (AAAA-MM-DD HH:MM:SS)">(Timestamp)</span>.
                            </p>
                        </div>

                        <!-- 2. Warning -->
                        <div class="bento-box" onclick="openConceptModal('importante')"
                            style="border-left: 4px solid var(--rose); background: rgba(244, 63, 94, 0.05); cursor: pointer; transition: transform 0.2s;"
                            onmouseover="this.style.transform='scale(1.02)'"
                            onmouseout="this.style.transform='scale(1)'">
                            <h3 style="color: var(--rose); font-size: 1rem; margin-bottom: 0.5rem;"><i
                                    class="fa-solid fa-circle-exclamation"></i> IMPORTANTE <i
                                    class="fa-solid fa-circle-info"
                                    style="font-size: 0.8rem; opacity: 0.5; margin-left: 0.5rem;"></i></h3>
                            <p style="font-size: 0.95rem;">Esta tabla <strong>NO SABE</strong> qu√© producto se compr√≥ ni
                                cu√°nto cost√≥.</p>
                        </div>

                        <!-- 3. Rule of Gold -->
                        <div class="bento-box" onclick="openConceptModal('regla')"
                            style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), transparent); border: 1px solid var(--amber); cursor: pointer; transition: transform 0.2s;"
                            onmouseover="this.style.transform='scale(1.02)'"
                            onmouseout="this.style.transform='scale(1)'">
                            <h3 style="color: var(--amber); margin-bottom: 0.5rem;"><i class="fa-solid fa-star"></i>
                                Regla de Oro <i class="fa-solid fa-circle-info"
                                    style="font-size: 0.8rem; opacity: 0.5; margin-left: 0.5rem;"></i></h3>
                            <p style="font-size: 1.1rem; font-weight: bold;">Filtrar solo <code>delivered</code></p>
                            <p style="font-size: 0.85rem; margin-top: 0.5rem; opacity: 0.8;">
                                Existen √≥rdenes 'cancelled' o 'shipped'. Si no filtras, estar√°s reportando ventas
                                falsas.
                            </p>
                        </div>

                    </div>

                    <!-- RIGHT COLUMN: Timeline & KPIs -->
                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">

                        <!-- 4. Timeline (Needs width) -->
                        <div class="bento-box" onclick="openConceptModal('lifecycle')"
                            style="flex: 0 0 auto; cursor: pointer; transition: transform 0.2s; position: relative;"
                            onmouseover="this.style.transform='scale(1.02)'"
                            onmouseout="this.style.transform='scale(1)'">
                            <h3
                                style="color: var(--text-muted); font-size: 1rem; margin-bottom: 0.8rem; text-align: center;">
                                El Ciclo de Vida del Pedido (5 Fechas Clave)
                            </h3>
                            <p
                                style="font-size: 0.9rem; text-align: center; opacity: 0.8; margin-bottom: 1.2rem; line-height: 1.5;">
                                Cada pedido pasa por <strong>5 momentos</strong> registrados con timestamps.
                                Estas fechas nos permiten calcular demoras, identificar retrasos y medir la experiencia
                                del cliente.
                                <i class="fa-solid fa-circle-info"
                                    style="margin-left: 0.5rem; font-size: 0.75rem; opacity: 0.5;"></i>
                            </p>
                            <div class="timeline" style="transform: scale(0.95); width: 100%;">
                                <div class="time-point active">
                                    <div class="time-dot"></div>
                                    <span class="time-label">Purchase</span>
                                    <span class="time-desc">Clic de compra</span>
                                </div>
                                <div class="time-point active">
                                    <div class="time-dot"></div>
                                    <span class="time-label">Approved</span>
                                    <span class="time-desc">Pago OK</span>
                                </div>
                                <div class="time-point active">
                                    <div class="time-dot"></div>
                                    <span class="time-label">Carrier</span>
                                    <span class="time-desc">En camino</span>
                                </div>
                                <div class="time-point active">
                                    <div class="time-dot"></div>
                                    <span class="time-label">Customer</span>
                                    <span class="time-desc"
                                        style="color: var(--emerald); font-weight: bold;">¬°Recibido!</span>
                                </div>
                                <div class="time-point warning">
                                    <div class="time-dot"></div>
                                    <span class="time-label">Estimated</span>
                                    <span class="time-desc">La Promesa <span class="term"
                                            data-tooltip="Fecha Estimada: La fecha l√≠mite que el sistema le prometi√≥ al cliente.">(Target)</span></span>
                                </div>
                            </div>
                        </div>


                        <!-- 5. KPIs -->
                        <div class="bento-box" onclick="openConceptModal('kpis')"
                            style="flex: 1; display: flex; flex-direction: column; justify-content: center; background: rgba(16, 185, 129, 0.05); border: 1px solid rgba(16, 185, 129, 0.2); cursor: pointer; transition: transform 0.2s; position: relative;"
                            onmouseover="this.style.transform='scale(1.02)'"
                            onmouseout="this.style.transform='scale(1)'">
                            <h3 style="color: var(--emerald); margin-bottom: 0.8rem;">
                                KPIs que calcularemos hoy:
                                <i class="fa-solid fa-circle-info"
                                    style="margin-left: 0.5rem; font-size: 0.75rem; opacity: 0.5;"></i>
                            </h3>
                            <p style="font-size: 0.9rem; margin-bottom: 1rem; opacity: 0.9; line-height: 1.5;">
                                Estos indicadores miden la <strong>experiencia del cliente</strong>. Nos dicen si Olist
                                cumple sus promesas
                                y d√≥nde est√°n los cuellos de botella en la log√≠stica.
                            </p>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <!-- KPI 1 -->
                                <div style="padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;">
                                    <strong style="color: #fff;">1. Demora Real</strong>
                                    <div style="margin: 0.5rem 0; font-family: monospace; font-size: 0.9rem;">
                                        <span style="color: var(--emerald);">delivered</span> - <span
                                            style="color: var(--primary);">purchase</span>
                                    </div>
                                    <p style="font-size: 0.85rem; opacity: 0.85; line-height: 1.4; margin-top: 0.5rem;">
                                        <strong>¬øQu√© mide?</strong> El tiempo total desde que el cliente hizo clic en
                                        "Comprar"
                                        hasta que recibi√≥ su producto. Es la <em>experiencia real</em> del cliente.
                                    </p>
                                </div>

                                <!-- KPI 2 -->
                                <div style="padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 8px;">
                                    <strong style="color: #fff;">2. "Delay" (Retraso)</strong>
                                    <div style="margin: 0.5rem 0; font-family: monospace; font-size: 0.9rem;">
                                        <span style="color: var(--emerald);">delivered</span> - <span
                                            style="color: var(--amber);">estimated</span>
                                    </div>
                                    <p style="font-size: 0.85rem; opacity: 0.85; line-height: 1.4; margin-top: 0.5rem;">
                                        <strong>¬øQu√© mide?</strong> Si Olist cumpli√≥ su promesa de entrega.
                                        Un n√∫mero <span style="color: var(--rose);">positivo</span> significa que lleg√≥
                                        tarde.
                                        Un n√∫mero <span style="color: var(--emerald);">negativo</span> significa que
                                        lleg√≥ antes (¬°cliente feliz!).
                                    </p>
                                </div>
                            </div>
                        </div>


                    </div>

                </div>
            </div>
        </div>

        <!-- SLIDE 4: Items & Money -->
<!-- SLIDE 4: Items & Money -->
<div class="slide">
    <div class="card" style="padding: 3rem; display: flex; flex-direction: column;">
        <h2 style="margin-bottom: 2rem;">Dinero y Detalle: <code style="color: var(--secondary);">olist_items</code>
        </h2>

        <div class="grid-2" style="gap: 4rem; align-items: start;">

            <!-- LEFT: Narrative Structure (Anatomy) -->
            <div class="bento-box"
                style="justify-content: flex-start; text-align: left; padding: 2.5rem; background: rgba(30, 41, 59, 0.4); border: 1px solid rgba(255,255,255,0.1);">
                <h3 style="color: var(--secondary); margin-bottom: 1.5rem; font-size: 1.4rem;">
                    <i class="fa-solid fa-diagram-project"></i> Anatom√≠a de una Orden
                </h3>

                <p style="margin-bottom: 2rem; font-size: 1.1rem; line-height: 1.6; opacity: 0.9;">
                    Esta tabla es el coraz√≥n. Una orden (#123) puede tener m√∫ltiples items. Amazon no te env√≠a 3 cajas
                    distintas, te env√≠a 1 caja con 3 cosas.
                </p>

                <!-- Visual Receipt -->
                <div
                    style="background: #fff; color: #000; padding: 1.5rem; border-radius: 4px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); font-family: 'Courier New', monospace; position: relative; transform: rotate(-2deg); margin: 1rem 0;">
                    <div
                        style="text-align: center; border-bottom: 1px dashed #000; padding-bottom: 0.5rem; margin-bottom: 0.5rem; font-weight: bold;">
                        OLIST MARKETPLACE</div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.2rem;">
                        <span>Item 1: TV 4K</span>
                        <span>$500</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>Item 2: HDMI Cable</span>
                        <span>$10</span>
                    </div>
                    <div
                        style="border-top: 1px solid #000; padding-top: 0.5rem; display: flex; justify-content: space-between; font-weight: bold;">
                        <span>TOTAL</span>
                        <span>$510</span>
                    </div>
                    <div
                        style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 20px; height: 20px; background: radial-gradient(circle, #333 20%, transparent 20%); background-size: 10px 10px; opacity: 0.1;">
                    </div>
                </div>

                <div
                    style="margin-top: 1.5rem; font-size: 0.9rem; opacity: 0.7; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1rem;">
                    <strong>Regla:</strong> 1 Fila = 1 Producto. (Si compras 5 cosas, tendr√°s 5 filas con el mismo
                    <code>order_id</code>).
                </div>
            </div>

            <!-- RIGHT: Money Flow Dashboard -->
            <div style="display: flex; flex-direction: column; gap: 2rem;">

                <div
                    style="background: rgba(16, 185, 129, 0.05); padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--emerald);">
                    <div
                        style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                        <h4 style="color: var(--emerald); font-size: 1.1rem; margin: 0;">üí∞ Price (Precio)</h4>
                        <span
                            style="background: var(--emerald); color: #000; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">INGRESO</span>
                    </div>
                    <p style="font-size: 1rem; margin-bottom: 0.5rem;">El costo del producto.</p>
                    <p style="font-size: 0.9rem; opacity: 0.8;"><i class="fa-solid fa-arrow-right"></i> Va al
                        <strong>Vendedor</strong> (Seller).</p>
                </div>

                <div
                    style="background: rgba(59, 130, 246, 0.05); padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--primary);">
                    <div
                        style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                        <h4 style="color: var(--primary); font-size: 1.1rem; margin: 0;">üöö Freight (Env√≠o)</h4>
                        <span
                            style="background: var(--primary); color: #fff; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">COSTO</span>
                    </div>
                    <p style="font-size: 1rem; margin-bottom: 0.5rem;">El costo log√≠stico.</p>
                    <p style="font-size: 0.9rem; opacity: 0.8;"><i class="fa-solid fa-arrow-right"></i> Va a
                        <strong>Correos</strong> (Carrier). <br> <span style="color: var(--rose);">Olist NO toca
                            esto.</span></p>
                </div>

                <!-- KPI Snapshot -->
                <div
                    style="background: rgba(255,255,255,0.03); padding: 1.5rem; border-radius: 12px; margin-top: 0.5rem;">
                    <strong
                        style="display: block; margin-bottom: 0.5rem; font-size: 0.9rem; letter-spacing: 1px; color: var(--text-muted); text-transform: uppercase;">C√≥mo
                        calcular ventas (GMV)</strong>
                    <code
                        style="display: block; font-family: 'Fira Code', monospace; color: var(--emerald); font-size: 1.1rem;">items['price'].sum()</code>
                </div>

            </div>

        </div>
    </div>
</div>

<!-- SLIDE 5: Customer Trap -->
<div class="slide">
    <div class="card" style="padding: 3rem; display: flex; flex-direction: column;">

        <h2 style="margin-bottom: 2rem;">La Trampa del ID: <span style="font-size: 0.6em; opacity: 0.7;">Sessions vs
                Users</span></h2>

        <div class="grid-2" style="gap: 4rem; align-items: start;">

            <!-- LEFT: Narrative Context -->
            <div class="bento-box"
                style="justify-content: flex-start; text-align: left; padding: 2.5rem; background: rgba(30, 41, 59, 0.4); border: 1px solid rgba(255,255,255,0.1);">
                <h3 style="color: var(--rose); margin-bottom: 1.5rem; font-size: 1.4rem;">
                    <i class="fa-solid fa-person-circle-question"></i> ¬øQui√©n es el cliente?
                </h3>

                <p style="margin-bottom: 1.5rem; font-size: 1.1rem; line-height: 1.6; opacity: 0.9;">
                    Olist es un Marketplace. No tiene "cuentas de usuario" centralizadas de la manera tradicional.
                </p>

                <ul style="margin-bottom: 2rem; font-size: 1rem; line-height: 1.8; opacity: 0.8; padding-left: 1.2rem;">
                    <li>Cada compra genera un ID temporal (como un ticket de turno).</li>
                    <li>Si compras hoy y ma√±ana, tendr√°s IDs distintos.</li>
                    <li><strong>El problema:</strong> Si contamos estos IDs, creemos que tenemos el doble de clientes.
                    </li>
                </ul>

                <div
                    style="background: rgba(244, 63, 94, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--rose);">
                    <strong style="color: var(--rose); display: block; margin-bottom: 0.5rem;">Analog√≠a
                        Carnicer√≠a:</strong>
                    <p style="font-size: 0.9rem; margin: 0;">Sacas "Ticket A-50" hoy. Ma√±ana sacas "Ticket B-20". Eres
                        la misma persona, pero tienes dos n√∫meros distintos.</p>
                </div>
            </div>

            <!-- RIGHT: The Trap vs Solution Visuals -->
            <div style="display: flex; flex-direction: column; gap: 2rem;">

                <!-- The TRAP (Red) -->
                <div
                    style="background: rgba(244, 63, 94, 0.05); padding: 1.5rem; border-radius: 12px; border: 1px dashed var(--rose); position: relative;">
                    <span
                        style="position: absolute; top: -10px; right: 20px; background: var(--rose); color: white; padding: 2px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">EVITAR</span>

                    <h4
                        style="color: var(--rose); font-size: 1.2rem; margin-bottom: 0.5rem; font-family: 'Fira Code', monospace;">
                        customer_id</h4>
                    <p style="font-size: 0.9rem; margin-bottom: 1rem; opacity: 0.8;">El ID de la <strong>sesi√≥n</strong>
                        de compra.</p>

                    <div style="background: rgba(0,0,0,0.2); padding: 0.8rem; border-radius: 6px;">
                        <code style="color: var(--rose); font-size: 0.85rem;">orders['customer_id'].nunique()</code>
                        <div style="font-size: 0.75rem; margin-top: 4px; opacity: 0.6;">Resultado: Inflado (No son
                            personas reales)</div>
                    </div>
                </div>

                <!-- The SOLUTION (Green) -->
                <div
                    style="background: rgba(16, 185, 129, 0.05); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--emerald); box-shadow: 0 0 20px rgba(16, 185, 129, 0.1); position: relative;">
                    <span
                        style="position: absolute; top: -10px; right: 20px; background: var(--emerald); color: black; padding: 2px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: bold;">CORRECTO</span>

                    <h4
                        style="color: var(--emerald); font-size: 1.2rem; margin-bottom: 0.5rem; font-family: 'Fira Code', monospace;">
                        customer_unique_id</h4>
                    <p style="font-size: 0.9rem; margin-bottom: 1rem; opacity: 0.8;">La <strong>Huella Digital</strong>
                        real del usuario.</p>

                    <div style="background: rgba(0,0,0,0.2); padding: 0.8rem; border-radius: 6px;">
                        <code
                            style="color: var(--emerald); font-size: 0.85rem;">customers['customer_unique_id'].nunique()</code>
                        <div style="font-size: 0.75rem; margin-top: 4px; opacity: 0.6;">Resultado: Real (Conteo de
                            personas √∫nicas)</div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

        <!-- SLIDE 6: Context Layers -->
        <div class="slide">
            <div class="card" style="padding: 2rem; display: flex; flex-direction: column;">
                <h2 style="margin-bottom: 1rem;">Tablas de Contexto (Los Detalles)</h2>

                <div class="bento-grid"
                    style="grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 1.5rem;">

                    <!-- Products -->
                    <div class="bento-box"
                        style="justify-content: flex-start; align-items: stretch; text-align: left; padding: 1.5rem;">
                        <h3 style="color: var(--accent); margin-top: 0;"><i class="fa-solid fa-tags"></i> Products</h3>
                        <p style="margin-bottom: 0.5rem; flex: 1;">Dimensiones (peso, altura) para costos de env√≠o.</p>
                        <div
                            style="background: rgba(30, 41, 59, 0.6); padding: 0.8rem; border-radius: 12px; border: 1px solid var(--glass-border);">
                            <div style="font-size: 0.9rem; margin-bottom: 0.3rem;">
                                <strong style="color: var(--accent);">Problema:</strong> <code>product_category</code>
                                en Portugu√©s.
                            </div>
                            <div style="font-size: 0.9rem;">
                                <strong style="color: var(--emerald);">Soluci√≥n:</strong> JOIN con
                                <code>translation</code>.
                            </div>
                        </div>
                    </div>

                    <!-- Payments -->
                    <div class="bento-box"
                        style="justify-content: flex-start; align-items: stretch; text-align: left; padding: 1.5rem;">
                        <h3 style="margin-top: 0;"><i class="fa-solid fa-credit-card"></i> Payments</h3>
                        <p style="margin-bottom: 0.5rem; flex: 1;">Nos dice <strong>C√ìMO</strong> pagaron.</p>
                        <div
                            style="background: rgba(255, 255, 255, 0.05); padding: 0.8rem; border-radius: 12px; margin-top: auto;">
                            <code>payment_installments</code>:<br>
                            Brasil es econom√≠a de cr√©dito. Pagan todo a <strong>10-12 cuotas</strong>.
                        </div>
                    </div>

                    <!-- Reviews -->
                    <div class="bento-box"
                        style="justify-content: flex-start; align-items: stretch; text-align: left; padding: 1.5rem;">
                        <h3 style="margin-top: 0;"><i class="fa-solid fa-star"></i> Reviews</h3>
                        <p style="margin-bottom: 0.5rem; flex: 1;">Calificaci√≥n (1 a 5).</p>
                        <div
                            style="background: rgba(255, 255, 255, 0.05); padding: 0.8rem; border-radius: 12px; margin-top: auto; font-size: 0.9rem;">
                            <strong>Nota Curiosa:</strong> Review a la <strong>Orden</strong>, no al producto. <br>Env√≠o
                            malo = 1 estrella al producto.
                        </div>
                    </div>

                    <!-- Geo -->
                    <div class="bento-box"
                        style="justify-content: flex-start; align-items: stretch; text-align: left; padding: 1.5rem;">
                        <h3 style="margin-top: 0;"><i class="fa-solid fa-map-marked-alt"></i> Geo</h3>
                        <p style="margin-bottom: 0.5rem; flex: 1;">Latitud y Longitud por Zip Code.</p>
                        <div
                            style="background: rgba(244, 63, 94, 0.1); padding: 0.8rem; border-radius: 12px; margin-top: auto; border: 1px solid var(--rose);">
                            <strong style="color: var(--rose); display: block; margin-bottom: 0.3rem;">
                                <i class="fa-solid fa-triangle-exclamation"></i> Cuidado:
                            </strong>
                            <span style="font-size: 0.9rem;">Zip Code es un √°rea. Deben <strong>promediar</strong>
                                (Centroide) o duplicar√°n ventas.</span>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- SLIDE 7: The Join Map -->
        <div class="slide">
            <div class="card">
                <h2>El Flujo de Joins (La Receta)</h2>
                <div class="grid-2">
                    <div style="display: flex; flex-direction: column; justify-content: center;">
                        <p style="font-size: 1.3rem;">Para que no se pierdan programando, sigan esta ruta para crear su
                            <strong>"Tabl√≥n Maestro"</strong>:
                        </p>
                        <p>Es como armar un Lego. Empiezas con la base l√≥gica y vas agregando piezas.</p>
                    </div>

                    <div style="overflow-y: auto; padding-right: 1rem;">
                        <div class="join-step">
                            <div class="join-number">1</div>
                            <div>
                                <strong>Orders</strong>
                                <div class="explanation-text">Empiecen aqu√≠. Filtren status='delivered'. Esta es su
                                    base.</div>
                            </div>
                        </div>

                        <div style="display: flex; justify-content: center; height: 30px;">
                            <div style="width: 2px; background: rgba(255,255,255,0.1);"></div>
                        </div>

                        <div class="join-step">
                            <div class="join-number" style="background: var(--primary);">2</div>
                            <div>
                                JOIN <strong>Items</strong> <span style="font-size: 0.8rem; opacity: 0.5;">ON
                                    order_id</span>
                                <div class="explanation-text">Pegan productos a las √≥rdenes. Su tabla crece en filas (1
                                    orden -> 3 items).</div>
                            </div>
                        </div>

                        <div style="display: flex; justify-content: center; height: 30px;">
                            <div style="width: 2px; background: rgba(255,255,255,0.1);"></div>
                        </div>

                        <div class="join-step">
                            <div class="join-number">3</div>
                            <div>
                                JOIN <strong>Products</strong> <span style="font-size: 0.8rem; opacity: 0.5;">ON
                                    product_id</span>
                                <div class="explanation-text">Ahora saben QU√â son esos items (categor√≠a, peso).</div>
                            </div>
                        </div>

                        <div style="display: flex; justify-content: center; height: 30px;">
                            <div style="width: 2px; background: rgba(255,255,255,0.1);"></div>
                        </div>

                        <div class="join-step">
                            <div class="join-number">4</div>
                            <div>
                                JOIN <strong>Customers</strong> <span style="font-size: 0.8rem; opacity: 0.5;">ON
                                    customer_id</span>
                                <div class="explanation-text" style="color: var(--emerald);">¬°Crucial! Aqu√≠ obtienen el
                                    <code>customer_unique_id</code> y la ciudad.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 8: Sanity Checks -->
        <div class="slide">
            <div class="card">
                <h2>Sanity Checks <span style="color: var(--rose); font-size: 0.8em; opacity: 0.8;">("Examen
                        Sorpresa")</span></h2>
                <p style="margin-bottom: 3rem;">Antes de tirar c√≥digo, demostremos que entendemos el negocio.</p>

                <style>
                    .flip-card {
                        background-color: transparent;
                        width: 100%;
                        height: 100%;
                        min-height: 550px;
                        /* Senior Designer Fix: Force height for content */
                        perspective: 1000px;
                        cursor: pointer;
                    }

                    /* Compact version for Mosaic Grids (Shared slides) */
                    .flip-card.compact {
                        min-height: 320px;
                    }

                    .flip-card-inner {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        text-align: center;
                        transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                        transform-style: preserve-3d;
                    }

                    /* Click-based toggle instead of hover */
                    .flip-card.flipped .flip-card-inner {
                        transform: rotateY(180deg);
                    }

                    .flip-card-front,
                    .flip-card-back {
                        position: absolute;
                        width: 100%;
                        height: 100%;
                        -webkit-backface-visibility: hidden;
                        backface-visibility: hidden;
                        border-radius: 24px;
                        padding: 2.5rem;
                        display: flex;
                        flex-direction: column;
                        justify-content: center;
                        align-items: center;
                        box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.6);
                        border: 1px solid rgba(255, 255, 255, 0.05);
                        overflow: hidden;
                        /* Crucial for containment */
                    }

                    .flip-card-front {
                        background: rgba(15, 23, 42, 0.7);
                        background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.05), transparent), #0f172a;
                    }

                    .flip-card-back {
                        transform: rotateY(180deg);
                        background: #0f172a;
                        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
                        border: 1px solid rgba(255, 255, 255, 0.1);
                    }

                    .question-icon {
                        font-size: 2rem;
                        /* Larger icons */
                        margin-bottom: 0.6rem;
                        opacity: 0.9;
                    }

                    .question-text {
                        font-size: 1.15rem;
                        /* Larger text */
                        line-height: 1.4;
                        color: #e2e8f0;
                        font-weight: 500;
                    }

                    .answer-title {
                        font-size: 1.35rem;
                        /* Larger title */
                        font-weight: bold;
                        margin-bottom: 0.5rem;
                        text-transform: uppercase;
                        letter-spacing: 1.5px;
                    }

                    .card-hint {
                        position: absolute;
                        bottom: 1rem;
                        font-size: 0.75rem;
                        color: rgba(255, 255, 255, 0.5);
                        text-transform: uppercase;
                        letter-spacing: 2px;
                        font-weight: 600;
                        width: 100%;
                        text-align: center;
                    }

                    .answer-text {
                        font-size: 1.05rem;
                        opacity: 0.95;
                        line-height: 1.6;
                        text-align: left;
                        width: 100%;
                        height: 100%;
                        overflow-y: auto;
                        padding-right: 0.5rem;
                        display: flex;
                        flex-direction: column;
                        justify-content: center;
                    }

                    /* Custom Scrollbar */
                    .answer-text::-webkit-scrollbar {
                        width: 4px;
                    }

                    .answer-text::-webkit-scrollbar-thumb {
                        background: rgba(255, 255, 255, 0.2);
                        border-radius: 4px;
                    }
                </style>

                <!-- Design Rescue: Split-Attention Solution (Questions always visible) -->
                <style>
                    /* Scoped Styles for Split-View */
                    .split-container {
                        display: grid;
                        grid-template-columns: 1fr 1fr 1fr;
                        gap: 2rem;
                        width: 100%;
                        height: 100%;
                    }

                    .split-col {
                        display: flex;
                        flex-direction: column;
                        justify-content: flex-start;
                        height: 100%;
                        position: relative;
                    }

                    .question-box {
                        background: rgba(255, 255, 255, 0.05);
                        border: 1px solid rgba(255, 255, 255, 0.1);
                        border-radius: 16px;
                        padding: 1.5rem;
                        margin-bottom: 1rem;
                        transition: all 0.3s ease;
                        cursor: pointer;
                        z-index: 2;
                    }

                    .question-box:hover,
                    .question-box.active {
                        background: rgba(255, 255, 255, 0.1);
                        border-color: var(--primary);
                        transform: translateY(-5px);
                    }

                    .question-box.active {
                        border-bottom-left-radius: 0;
                        border-bottom-right-radius: 0;
                        margin-bottom: 0;
                        border-bottom: none;
                    }

                    .answer-pane {
                        background: rgba(15, 23, 42, 0.8);
                        border: 1px solid var(--primary);
                        border-top: none;
                        border-bottom-left-radius: 16px;
                        border-bottom-right-radius: 16px;
                        padding: 1.5rem;
                        opacity: 0;
                        transform: translateY(-10px);
                        pointer-events: none;
                        transition: all 0.3s ease;
                        height: 0;
                        overflow: hidden;
                    }

                    .question-box.active+.answer-pane {
                        opacity: 1;
                        transform: translateY(0);
                        pointer-events: all;
                        height: auto;
                        flex: 1;
                        /* Fill remaining space */
                        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
                    }
                </style>

                <div class="split-container">

                    <!-- COL 1: Money -->
                    <div class="split-col">
                        <div class="question-box" onclick="this.classList.toggle('active')">
                            <div style="font-size: 2rem; color: var(--primary); margin-bottom: 0.5rem;"><i
                                    class="fa-solid fa-coins"></i></div>
                            <h3 style="color: #fff; font-size: 1.1rem; margin-bottom: 0.5rem;">Total Ventas</h3>
                            <p style="font-size: 0.95rem; opacity: 0.8;">¬øSumar <code>price</code> en Items da el Valor
                                Bruto?</p>
                            <div style="font-size: 0.8rem; color: var(--primary); margin-top: 0.5rem;">Click para
                                respuesta ‚ñº</div>
                        </div>
                        <div class="answer-pane">
                            <strong
                                style="color: var(--primary); font-size: 1.2rem; display: block; margin-bottom: 0.5rem;">¬°S√ç!</strong>
                            <p style="font-size: 0.9rem;">La tabla <code>Items</code> tiene una fila por CADA unidad
                                vendida.</p>
                            <ul style="font-size: 0.9rem; padding-left: 1.2rem; margin-top: 0.5rem; opacity: 0.8;">
                                <li>Suma del precio base.</li>
                                <li>NO incluye flete.</li>
                                <li>Coincide con Payments.</li>
                            </ul>
                        </div>
                    </div>

                    <!-- COL 2: Customers -->
                    <div class="split-col">
                        <div class="question-box" onclick="this.classList.toggle('active')"
                            style="border-color: rgba(244, 63, 94, 0.3);">
                            <div style="font-size: 2rem; color: var(--rose); margin-bottom: 0.5rem;"><i
                                    class="fa-solid fa-users-slash"></i></div>
                            <h3 style="color: #fff; font-size: 1.1rem; margin-bottom: 0.5rem;">Conteo Clientes</h3>
                            <p style="font-size: 0.95rem; opacity: 0.8;">¬øContar <code>customer_id</code> da clientes
                                √∫nicos?</p>
                            <div style="font-size: 0.8rem; color: var(--rose); margin-top: 0.5rem;">Click para respuesta
                                ‚ñº</div>
                        </div>
                        <div class="answer-pane" style="border-color: var(--rose);">
                            <strong
                                style="color: var(--rose); font-size: 1.2rem; display: block; margin-bottom: 0.5rem;">¬°NO!
                                üö®</strong>
                            <p style="font-size: 0.9rem;"><code>customer_id</code> cambia en cada compra.</p>
                            <div
                                style="background: rgba(244, 63, 94, 0.1); padding: 0.5rem; border-radius: 4px; margin-top: 0.5rem;">
                                <span style="font-size: 0.85rem;">Usa: <strong>customer_unique_id</strong></span>
                            </div>
                        </div>
                    </div>

                    <!-- COL 3: Joins -->
                    <div class="split-col">
                        <div class="question-box" onclick="this.classList.toggle('active')"
                            style="border-color: rgba(16, 185, 129, 0.3);">
                            <div style="font-size: 2rem; color: var(--emerald); margin-bottom: 0.5rem;"><i
                                    class="fa-solid fa-table-list"></i></div>
                            <h3 style="color: #fff; font-size: 1.1rem; margin-bottom: 0.5rem;">Filas Duplicadas</h3>
                            <p style="font-size: 0.95rem; opacity: 0.8;">Join Orders + Items = ¬øM√°s filas?</p>
                            <div style="font-size: 0.8rem; color: var(--emerald); margin-top: 0.5rem;">Click para
                                respuesta ‚ñº</div>
                        </div>
                        <div class="answer-pane" style="border-color: var(--emerald);">
                            <strong
                                style="color: var(--emerald); font-size: 1.2rem; display: block; margin-bottom: 0.5rem;">Es
                                Normal (1:N)</strong>
                            <p style="font-size: 0.9rem;">1 Orden puede tener 5 productos.</p>
                            <ul style="font-size: 0.9rem; padding-left: 1.2rem; margin-top: 0.5rem; opacity: 0.8;">
                                <li>La orden se repite por cada item.</li>
                                <li>El dataset crece naturalmente.</li>
                            </ul>
                        </div>
                    </div>

                </div>

            </div>
        </div>

        <!-- SLIDE 9: Intro Part II -->
        <div class="slide">
            <div class="card"
                style="display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: radial-gradient(circle at center, rgba(34, 211, 238, 0.15) 0%, rgba(15, 23, 42, 0.98) 70%); border: 1px solid var(--accent); padding: 3rem; position: relative; overflow: hidden;">

                <!-- Background decoration -->
                <div
                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: linear-gradient(rgba(34, 211, 238, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 211, 238, 0.05) 1px, transparent 1px); background-size: 50px 50px; opacity: 0.5; pointer-events: none;">
                </div>

                <!-- Eyebrow -->
                <div
                    style="font-size: 1.5rem; letter-spacing: 0.5em; text-transform: uppercase; color: var(--accent); margin-bottom: 2rem; font-weight: 600; text-shadow: 0 0 10px rgba(34, 211, 238, 0.5);">
                    Parte II
                </div>

                <!-- Hero Title -->
                <h1
                    style="font-size: 5rem; line-height: 1.1; margin-bottom: 2rem; color: #fff; font-weight: 800; text-shadow: 0 5px 15px rgba(0,0,0,0.5);">
                    Ejecuci√≥n del <br>
                    <span
                        style="background: linear-gradient(to right, #fff, var(--accent)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">An√°lisis
                        Exploratorio</span>
                </h1>

                <!-- Divider -->
                <div
                    style="width: 100px; height: 6px; background: var(--accent); margin-bottom: 2.5rem; border-radius: 3px; box-shadow: 0 0 15px var(--accent);">
                </div>

                <!-- Subtitle -->
                <p style="font-size: 1.8rem; color: var(--text-muted); max-width: 800px; font-weight: 300;">
                    De <span style="color: #fff; border-bottom: 1px solid rgba(255,255,255,0.3);">CSVs sueltos</span> a
                    <span style="color: #fff; font-weight: 600;">Insights de Negocio</span> aplicables.
                </p>
            </div>
        </div>

        <!-- SLIDE 10: The Golden Rule -->
        <div class="slide">
            <div class="card"
                style="display: flex; flex-direction: column; justify-content: center; padding: 3rem; border: 2px solid var(--rose); box-shadow: 0 0 50px rgba(244, 63, 94, 0.1);">
                <div style="text-align: center; margin-bottom: 3rem;">
                    <div style="font-size: 4rem; color: var(--rose); margin-bottom: 1rem;"><i
                            class="fa-solid fa-hand"></i></div>
                    <h2
                        style="font-size: 3rem; color: var(--rose); margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 2px;">
                        La Regla de Oro</h2>
                    <p style="font-size: 1.5rem; opacity: 0.9;">Antes de graficar, hay que <strong
                            style="text-decoration: underline; text-decoration-color: var(--rose);">FILTRAR</strong>.
                    </p>
                </div>

                <div class="grid-2" style="gap: 3rem; align-items: stretch;">
                    <div
                        style="background: rgba(244, 63, 94, 0.08); padding: 2rem; border-radius: 20px; border-left: 6px solid var(--rose); display: flex; flex-direction: column; justify-content: center;">
                        <h3 style="color: var(--rose); font-size: 1.5rem; margin-bottom: 1rem;"><i
                                class="fa-solid fa-triangle-exclamation"></i> El Error</h3>
                        <p style="font-size: 1.2rem; line-height: 1.6;">Si incluyen <code>cancelled</code> o
                            <code>unavailable</code>, <strong>ensuciar√°n</strong> todos sus c√°lculos de ventas reales y
                            tiempos de entrega.
                        </p>
                    </div>

                    <div
                        style="background: rgba(16, 185, 129, 0.08); padding: 2rem; border-radius: 20px; border-left: 6px solid var(--emerald); display: flex; flex-direction: column; justify-content: center;">
                        <h3 style="color: var(--emerald); font-size: 1.5rem; margin-bottom: 1rem;"><i
                                class="fa-solid fa-code"></i> La Instrucci√≥n</h3>
                        <pre
                            style="background: rgba(0,0,0,0.3); padding: 1.5rem; border-radius: 10px; font-size: 1.1rem; overflow-x: auto; color: var(--emerald); margin: 0;"># Solo ventas reales ("entregadas")
orders = orders[orders['order_status'] == 'delivered']</pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 11: Trends -->
        <div class="slide">
            <div class="card" style="padding: 3rem; display: flex; flex-direction: column;">
<h2 style="margin-bottom: 2rem;">1. An√°lisis de Tendencias</h2>

<div class="grid-2" style="gap: 4rem; align-items: start;">

    <!-- LEFT: Narrative Context (Text Only, No Card) -->
    <div style="text-align: left; padding-right: 1rem;">

        <!-- History Block -->
        <div style="margin-bottom: 3rem;">
            <h3
                style="color: var(--accent); font-size: 1.6rem; margin-bottom: 1rem; border-left: 4px solid var(--accent); padding-left: 1rem;">
                Contexto Hist√≥rico: El Colapso de 2017</h3>
            <p style="font-size: 1.1rem; line-height: 1.8; opacity: 0.9; margin-bottom: 1.5rem;">
                En Noviembre de 2017, Olist enfrent√≥ su primer <strong>Black Friday</strong> masivo. La demanda se
                triplic√≥ en 24 horas, saturando la capacidad log√≠stica de los vendedores.
            </p>
            <p style="font-size: 1.1rem; line-height: 1.8; opacity: 0.9;">
                <i class="fa-solid fa-arrow-right" style="color: var(--accent);"></i> <strong>El Objetivo:</strong> No
                estamos solo "analizando ventas". Estamos usando los datos de 2017 para dimensionar la operaci√≥n de 2018
                y evitar otro colapso.
            </p>
        </div>

        <!-- Technical Specs (Smaller, Secondary) -->
        <div>
            <h4
                style="color: var(--text-muted); font-size: 1.1rem; margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 1px;">
                Requerimientos T√©cnicos</h4>
            <ul style="font-size: 1rem; line-height: 1.6; color: var(--text-muted); list-style: none; padding: 0;">
                <li style="margin-bottom: 0.5rem;"><i class="fa-solid fa-code"
                        style="margin-right: 8px; color: var(--primary);"></i> <strong>Variable:</strong>
                    <code>order_purchase_timestamp</code></li>
                <li style="margin-bottom: 0.5rem;"><i class="fa-solid fa-filter"
                        style="margin-right: 8px; color: var(--primary);"></i> <strong>Transformaci√≥n:</strong> str ‚Üí
                    datetime</li>
                <li><i class="fa-solid fa-layer-group" style="margin-right: 8px; color: var(--primary);"></i>
                    <strong>Agrupaci√≥n:</strong> YYYY-MM</li>
            </ul>
        </div>
    </div>

    <!-- RIGHT: Visual Anchor (Compact Card) -->
    <div style="display: flex; justify-content: center;">
        <div class="flip-card" onclick="this.classList.toggle('flipped')"
            style="cursor: pointer; width: 100%; max-width: 400px; height: 350px;">
            <div class="flip-card-inner">
                <!-- Front: minimal Data Anchor -->
                <div class="flip-card-front"
                    style="background: rgba(245, 158, 11, 0.05); border-color: var(--amber); justify-content: center;">

                    <!-- Hero Data Point -->
                    <div style="text-align: center;">
                        <div
                            style="font-size: 0.9rem; color: var(--amber); letter-spacing: 2px; margin-bottom: 0.8rem; text-transform: uppercase; opacity: 0.8;">
                            El Pico M√°ximo</div>
                        <div
                            style="font-size: 4rem; font-weight: 900; color: #fff; line-height: 1; text-shadow: 0 0 30px rgba(245, 158, 11, 0.4);">
                            NOV '17</div>
                        <div style="font-size: 1.3rem; color: var(--amber); margin-top: 0.8rem; font-weight: 300;">Black
                            Friday</div>
                    </div>

                    <div class="card-hint">Click para contexto estrategico</div>
                </div>

                <!-- Back: The Context -->
                <div class="flip-card-back" style="background: #1e293b; border-color: var(--amber); padding: 2rem;">
                    <div class="answer-title" style="color: var(--amber); margin-bottom: 1rem; font-size: 1.3rem;">
                        Lecci√≥n Aprendida</div>
                    <div class="answer-text" style="text-align: left; font-size: 1rem; line-height: 1.6;">
                        <p style="margin-bottom: 1rem;">El pico no es aleatorio, es <strong>estacionalidad
                                forzada</strong>.</p>
                        <ul style="padding-left: 1.2rem;">
                            <li style="margin-bottom: 0.5rem;"><strong>Impacto:</strong> +300% Carga Log√≠stica.</li>
                            <li><strong>Acci√≥n:</strong> Contratar flota extra en Octubre.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>            </div>
        </div>


        <!-- SLIDE 12: Anomalies & Outliers -->
        <div class="slide">
            <div class="card" style="padding: 3rem; display: flex; flex-direction: column;">
<h2 style="margin-bottom: 2rem;">2. Detecci√≥n de Anomal√≠as <span style="font-size: 0.6em; opacity: 0.7;">(Clean
        Data)</span></h2>

<div class="grid-2" style="gap: 4rem; align-items: start;">

    <!-- LEFT: Tech Setup (Feature Engineering) -->
    <div class="bento-box"
        style="justify-content: flex-start; align-items: stretch; text-align: left; padding: 2.5rem; background: rgba(30, 41, 59, 0.4); border: 1px solid rgba(255,255,255,0.1);">

        <h3 style="color: var(--amber); margin-bottom: 1.5rem; font-size: 1.4rem;">Ingenier√≠a de Variables</h3>
        <p style="margin-bottom: 2rem; opacity: 0.9; font-size: 1.1rem; line-height: 1.6;">
            El CEO dice que la log√≠stica es un desastre. ¬øVerdad o mentira?
        </p>

        <!-- Calculation Card -->
        <div
            style="background: rgba(15, 23, 42, 0.6); padding: 2rem; border-radius: 12px; margin-bottom: 2.5rem; border: 1px solid rgba(255,255,255,0.05); box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);">
            <strong style="display: block; margin-bottom: 1rem; color: #fff; font-size: 1.1rem;">
                <span style="border-bottom: 2px dashed var(--primary); padding-bottom: 2px;">Lead Time</span> (Tiempo de
                Ciclo):
            </strong>
            <code
                style="display: block; color: var(--amber); font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; font-family: 'Fira Code', monospace;">
                                delivery_date - purchase_date
                            </code>
            <div style="font-size: 0.9rem; opacity: 0.6;">(Convertir a d√≠as num√©ricos)</div>
        </div>

        <!-- Analysis Tools -->
        <div>
            <p style="margin-bottom: 1rem; font-size: 1.1rem;">
                <strong>Herramienta:</strong> <u
                    style="text-decoration-color: var(--text-muted); text-underline-offset: 4px;">Boxplot</u> (Diagrama
                de Caja)
            </p>
            <ul style="font-size: 1.05rem; padding-left: 1.2rem; opacity: 0.8; line-height: 1.8;">
                <li>Caja aplastada (10-15 d√≠as).</li>
                <li>Nube de puntos negros (<span
                        style="color: var(--text-muted); border-bottom: 1px dotted var(--text-muted);">Outliers</span>).
                </li>
            </ul>
        </div>
    </div>

    <!-- RIGHT: Critical Cases (Cards) -->
    <div style="display: flex; flex-direction: column; gap: 2rem;">

        <!-- Case A: Red (Drop) -->
        <div
            style="background: rgba(220, 38, 38, 0.08); padding: 2rem; border-radius: 12px; border: 1px solid rgba(220, 38, 38, 0.4); position: relative; overflow: hidden;">
            <!-- Top Strip -->
            <div style="position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: #ef4444;"></div>

            <h4 style="color: #ef4444; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 700;">Caso A: Tiempos
                Negativos (-5 d√≠as)</h4>
            <p style="font-size: 1rem; margin-bottom: 1.5rem; opacity: 0.9;">Viajes en el tiempo. Error de sistema.</p>

            <div
                style="background: #ef4444; color: white; display: inline-block; padding: 6px 16px; border-radius: 4px; font-size: 0.85rem; font-weight: 800; letter-spacing: 0.5px; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);">
                ACCI√ìN: ELIMINAR (DROP)
            </div>
        </div>

        <!-- Case B: Orange (Analyze) -->
        <div
            style="background: rgba(245, 158, 11, 0.08); padding: 2rem; border-radius: 12px; border: 1px solid rgba(245, 158, 11, 0.4); position: relative; overflow: hidden;">
            <!-- Top Strip -->
            <div style="position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: #f59e0b;"></div>

            <h4 style="color: #f59e0b; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 700;">Caso B: Extremos
                (180+ d√≠as)</h4>
            <p style="font-size: 1rem; margin-bottom: 1.5rem; opacity: 0.9;">Paquetes perdidos en Correos. No es error
                de dedo.</p>

            <div
                style="background: #f59e0b; color: black; display: inline-block; padding: 6px 16px; border-radius: 4px; font-size: 0.85rem; font-weight: 800; letter-spacing: 0.5px; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                ACCI√ìN: MANTENER Y ANALIZAR
            </div>
        </div>

    </div>

</div>            </div>
        </div>

<!-- SLIDE 13: Advanced Visualization -->
<div class="slide">
    <div class="card" style="padding: 3rem; display: flex; flex-direction: column;">
        <h2 style="margin-bottom: 2rem;">3. Visualizaci√≥n Multidimensional</h2>

        <div class="grid-2" style="gap: 4rem; align-items: start;">

            <!-- LEFT: Narrative Context -->
            <div class="bento-box"
                style="justify-content: flex-start; text-align: left; padding: 2.5rem; background: rgba(30, 41, 59, 0.4); border: 1px solid rgba(255,255,255,0.1);">
                <h3 style="color: var(--secondary); margin-bottom: 1.5rem; font-size: 1.4rem;">Hip√≥tesis: Peso vs Precio
                </h3>
                <p style="font-size: 1.1rem; line-height: 1.6; margin-bottom: 2rem; opacity: 0.9;">
                    "¬øPesar m√°s hace que el env√≠o sea m√°s caro siempre?" <br>
                    <em style="opacity: 0.7;">Sentido com√∫n, ¬øcierto?</em>
                </p>

                <div
                    style="background: rgba(139, 92, 246, 0.1); padding: 1.5rem; border-radius: 8px; border-left: 4px solid var(--secondary);">
                    <strong style="color: var(--secondary); display: block; margin-bottom: 0.5rem;">El
                        Hallazgo:</strong>
                    <p style="font-size: 1rem; margin: 0;">Los datos muestran puntos del <strong>mismo peso</strong> con
                        precios radicalmente distintos.</p>
                </div>

                <ul
                    style="margin-top: 2rem; font-size: 1rem; line-height: 2; padding-left: 1.5rem; color: var(--text-muted);">
                    <li><strong>Eje X:</strong> Peso (g)</li>
                    <li><strong>Eje Y:</strong> Valor Flete ($)</li>
                    <li><strong>Color:</strong> Estado (SP, RJ, MG)</li>
                </ul>
            </div>

            <!-- RIGHT: Visual Insight Widget -->
            <div style="display: flex; flex-direction: column; gap: 2rem;">
                <!-- Chart Representation -->
                <div
                    style="background: rgba(15, 23, 42, 0.6); padding: 2rem; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05); position: relative; height: 300px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                    <!-- Mock Scatter Dots -->
                    <div
                        style="position: absolute; width: 6px; height: 6px; background: var(--secondary); border-radius: 50%; top: 40%; left: 20%; box-shadow: 0 0 10px var(--secondary);">
                    </div>
                    <div
                        style="position: absolute; width: 8px; height: 8px; background: var(--rose); border-radius: 50%; top: 30%; left: 25%; opacity: 0.6;">
                    </div>
                    <div
                        style="position: absolute; width: 6px; height: 6px; background: var(--secondary); border-radius: 50%; top: 60%; left: 80%; box-shadow: 0 0 10px var(--secondary);">
                    </div>
                    <div
                        style="position: absolute; width: 10px; height: 10px; background: var(--emerald); border-radius: 50%; top: 20%; left: 60%; opacity: 0.6;">
                    </div>

                    <div style="text-align: center; z-index: 2;">
                        <h4 style="font-size: 1.5rem; font-weight: 800; color: #fff; margin-bottom: 0.5rem;">LA
                            DISTANCIA</h4>
                        <p style="font-size: 1rem; color: var(--text-muted);">Importa m√°s que el peso</p>
                    </div>

                    <!-- Grid Lines -->
                    <div
                        style="position: absolute; bottom: 20px; left: 20px; right: 20px; height: 1px; background: rgba(255,255,255,0.1);">
                    </div>
                    <div
                        style="position: absolute; top: 20px; bottom: 20px; left: 20px; width: 1px; background: rgba(255,255,255,0.1);">
                    </div>
                </div>

                <!-- Context Badge -->
                <div
                    style="background: rgba(139, 92, 246, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--secondary); display: flex; align-items: center; gap: 1rem;">
                    <div style="font-size: 2rem;">üáßüá∑</div>
                    <div>
                        <strong
                            style="color: var(--secondary); display: block; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">Contexto
                            Geogr√°fico</strong>
                        <p style="font-size: 0.9rem; margin: 0; opacity: 0.8;">"El c√≥digo postal es el rey del costo".
                            (Amazonas vs Sao Paulo)</p>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- SLIDE 14: Correlations -->
<div class="slide">
    <div class="card" style="padding: 3rem; display: flex; flex-direction: column;">
        <h2 style="margin-bottom: 2rem;">4. Correlaciones (¬øQu√© importa?)</h2>

        <div class="grid-2" style="gap: 4rem; align-items: start;">

            <!-- LEFT: Tech Matrix -->
            <div class="bento-box"
                style="justify-content: flex-start; text-align: left; padding: 2.5rem; background: rgba(30, 41, 59, 0.4); border: 1px solid rgba(255,255,255,0.1);">
                <h3 style="color: var(--emerald); margin-bottom: 1.5rem; font-size: 1.4rem;">La Matriz de Verdad</h3>
                <p style="margin-bottom: 2rem; font-size: 1.1rem; line-height: 1.6; opacity: 0.9;">
                    Usamos un <strong>Heatmap</strong> (Mapa de Calor) para cruzar todas las variables num√©ricas y
                    encontrar relaciones ocultas.
                </p>

                <div style="display: flex; gap: 2rem;">
                    <ul
                        style="font-family: 'Fira Code', monospace; font-size: 0.9rem; color: var(--emerald); line-height: 2; list-style: none; padding: 0;">
                        <li><i class="fa-solid fa-check" style="margin-right: 8px; opacity: 0.5;"></i>price</li>
                        <li><i class="fa-solid fa-check" style="margin-right: 8px; opacity: 0.5;"></i>freight_value</li>
                    </ul>
                    <ul
                        style="font-family: 'Fira Code', monospace; font-size: 0.9rem; color: var(--emerald); line-height: 2; list-style: none; padding: 0;">
                        <li><i class="fa-solid fa-check" style="margin-right: 8px; opacity: 0.5;"></i>photos_qty</li>
                        <li style="border-bottom: 1px dashed var(--emerald);"><i class="fa-solid fa-star"
                                style="margin-right: 8px;"></i>review_score</li>
                    </ul>
                </div>
            </div>

            <!-- RIGHT: Insight Dashboard -->
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">

                <!-- Insight 1: Disappointment -->
                <div
                    style="background: rgba(255,255,255,0.03); padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--text-muted);">
                    <h4
                        style="color: var(--text-muted); font-size: 1rem; margin-bottom: 0.5rem; text-transform: uppercase;">
                        üìâ Decepci√≥n de Negocio</h4>
                    <p style="font-size: 1.1rem;"><code>Price</code> vs <code>Review</code> ‚âà 0</p>
                    <div style="font-size: 0.85rem; opacity: 0.6; margin-top: 0.5rem;">(Ser barato no te compra 5
                        estrellas)</div>
                </div>

                <!-- Insight 2: The Truth -->
                <div
                    style="background: rgba(244, 63, 94, 0.1); padding: 2rem; border-radius: 12px; border: 1px solid var(--rose); box-shadow: 0 4px 20px rgba(244, 63, 94, 0.15);">
                    <h4
                        style="color: var(--rose); font-size: 1.2rem; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fa-solid fa-heart-crack"></i> Hallazgo Real (-0.4)
                    </h4>
                    <p style="font-size: 1.2rem; font-weight: bold; color: #fff; margin-bottom: 0.5rem;">"La gente odia
                        esperar."</p>
                    <p style="font-size: 1rem; opacity: 0.9; line-height: 1.5;">Correlaci√≥n Negativa fuerte entre
                        <em>Tiempo de Entrega</em> y <em>Score</em>.</p>

                    <div
                        style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid rgba(244, 63, 94, 0.3); color: var(--rose); font-size: 0.9rem; font-weight: 700;">
                        LOG√çSTICA MATA PRODUCTO
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
        <!-- SLIDE 15: Closing / Deliverables -->
        <div class="slide">
            <div class="card"
                style="padding: 3rem; background: linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, rgba(16, 185, 129, 0.1) 100%); display: flex; flex-direction: column;">
                <h2 style="color: var(--emerald); font-size: 3rem; margin-bottom: 3rem; text-align: center;">Pr√≥xima
                    Semana: El Entregable</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; flex: 1;">
                    <div>
                        <h3 style="margin-bottom: 1.5rem; color: #fff;">1. Limpieza de Datos <span class="term"
                                data-tooltip="Data Cleaning: Proceso de detectar y corregir registros corruptos o inexactos.">(Cleaning)</span>
                        </h3>
                        <div
                            style="background: rgba(0,0,0,0.3); padding: 1.5rem; border-radius: 10px; margin-bottom: 2.5rem; font-family: 'Fira Code', monospace; line-height: 1.6; border: 1px solid var(--glass-border);">
                            Originales: 100,000 filas<br>
                            Finales: 96,000 filas<br>
                            <span style="color: var(--rose);">Eliminados: 4,000 (Cancelled)</span>
                        </div>

                        <h3 style="margin-bottom: 1.5rem; color: #fff;">2. An√°lisis Diagn√≥stico <span class="term"
                                data-tooltip="Entender POR QU√â ocurri√≥ algo (Causa-Efecto).">(Why?)</span></h3>
                        <ul style="font-size: 1.2rem; line-height: 2; padding-left: 1.5rem; opacity: 0.9;">
                            <li>Gr√°fico de Tendencia Temporal (Line).</li>
                            <li>Gr√°fico de Relaci√≥n (Scatter/Heatmap).</li>
                        </ul>
                    </div>

                    <div>
                        <h3 style="margin-bottom: 1.5rem; color: #fff;">3. An√°lisis Descriptivo <span class="term"
                                data-tooltip="Resumir QU√â pas√≥ en el pasado (Historia).">(What?)</span></h3>
                        <p style="margin-bottom: 2.5rem; font-size: 1.2rem; opacity: 0.9;"><span class="term"
                                data-tooltip="Gr√°fico que muestra la distribuci√≥n de frecuencias (forma de los datos).">Histograma</span>
                            de Ventas:
                            ¬øVendemos muchos baratos o pocos caros?</p>

                        <h3 style="margin-bottom: 1.5rem; color: #fff;">4. Conclusiones de Negocio</h3>
                        <div
                            style="background: rgba(16, 185, 129, 0.1); padding: 2rem; border-radius: 12px; border-left: 5px solid var(--emerald);">
                            <p style="font-size: 1.2rem; font-style: italic;">"Recomendamos reforzar stock en Octubre
                                para prepararse para el pico de Noviembre identificado en el an√°lisis de tendencias."
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    </div>
    </div>
    </div>

    </div>

    <!-- MODALS CONTAINER -->
    <div id="modals_container">
        <div id="modal-items" class="modal-overlay" onclick="closeModal(event)">
            <div class="modal-content">
                <button class="close-modal" onclick="closeModal(null, true)">&times;</button>
                <h2 style="color: var(--secondary);">Detalle: Items</h2>
                <p>Aqu√≠ es donde vive el producto f√≠sico.</p>
                <ul style="margin-top: 1rem;">
                    <li><strong>order_item_id:</strong> No es un ID √∫nico global. Es un contador (1, 2, 3...) reiniciado
                        para cada orden.</li>
                    <li><strong>seller_id:</strong> Ojo, Olist es un "Marketplace" (como MercadoLibre). Una misma orden
                        de un cliente puede tener productos de vendedor A y vendedor B.</li>
                </ul>
            </div>
        </div>

        <div id="modal-customers" class="modal-overlay" onclick="closeModal(event)">
            <div class="modal-content">
                <button class="close-modal" onclick="closeModal(null, true)">&times;</button>
                <h2 style="color: var(--rose);">Detalle: Customers</h2>
                <p>Es la tabla de "direcciones de env√≠o" y mapeo de IDs.</p>
                <p>Imaginen que <code>customer_id</code> es la etiqueta temporal de env√≠o en la caja, y
                    <code>customer_unique_id</code> es el registro del usuario en la base de datos central.
                </p>
            </div>
        </div>

        <div id="modal-reviews" class="modal-overlay" onclick="closeModal(event)">
            <div class="modal-content">
                <button class="close-modal" onclick="closeModal(null, true)">&times;</button>
                <h2 style="color: var(--amber);">Detalle: Reviews</h2>
                <p>Contiene el feedback emocional.</p>
                <p>Tiene un t√≠tulo (opcional) y un mensaje de texto (comentario). Es oro para an√°lisis de texto (NLP),
                    pero el 60% de las veces est√° vac√≠o porque a la gente le da pereza escribir.</p>
            </div>
        </div>

        <div id="modal-payments" class="modal-overlay" onclick="closeModal(event)">
            <div class="modal-content">
                <button class="close-modal" onclick="closeModal(null, true)">&times;</button>
                <h2 style="color: var(--emerald);">Detalle: Payments</h2>
                <p>La tabla financiera.</p>
                <p>Noten que una sola orden puede tener M√öLTIPLES filas de pago. Ejemplo: El cliente pag√≥ $50 con
                    tarjeta de cr√©dito y $20 con un cup√≥n (voucher). ¬°Tendr√°n 2 filas para la misma orden!</p>
            </div>
        </div>

        <!-- Concept Explanation Modal -->
        <div id="modal-concept" class="modal-overlay" onclick="closeModal(event)">
            <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
                <button class="close-modal" onclick="closeModal(null, true)">&times;</button>
                <h2 id="concept-title" style="margin-bottom: 1.5rem;"></h2>
                <div id="concept-content" style="line-height: 1.6;"></div>
            </div>
        </div>
    </div>

    <!-- Pandas Command Modal -->
    <div id="modal-pandas" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content" style="max-width: 900px; max-height: 85vh; overflow-y: auto;">
            <button class="close-modal" onclick="closeModal(null, true)">&times;</button>
            <h2 id="pandas-title" style="margin-bottom: 1.5rem;"></h2>
            <div id="pandas-content" style="line-height: 1.6;"></div>
        </div>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const progressBar = document.getElementById('progressBar');

        // Modal Logic
        function openModal(id) {
            const modal = document.getElementById(id);
            if (modal) modal.classList.add('active');
        }

        function closeModal(event, force = false) {
            if (force) {
                document.querySelectorAll('.modal-overlay').forEach(el => el.classList.remove('active'));
                return;
            }
            if (event.target.classList.contains('modal-overlay')) {
                event.target.classList.remove('active');
            }
        }

        // Concept Modal Logic
        function openConceptModal(conceptId) {
            const modal = document.getElementById('modal-concept');
            const title = document.getElementById('concept-title');
            const content = document.getElementById('concept-content');

            const concepts = {
                bitacora: {
                    title: 'Bit√°cora del Sistema',
                    color: 'var(--primary)',
                    content: `
                        <h4 style="color: var(--primary); margin-bottom: 1rem;">¬øQu√© es la Bit√°cora del Sistema?</h4>
                        <p style="margin-bottom: 1rem;">La tabla <code>olist_orders</code> es como el registro de un hotel: cada l√≠nea dice "El cliente X lleg√≥ el d√≠a Y".</p>
                        
                        <h4 style="color: var(--primary); margin: 1.5rem 0 1rem;">¬øQu√© informaci√≥n NO tiene esta tabla?</h4>
                        <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                            <li style="margin-bottom: 0.8rem;"><strong>Productos comprados:</strong> No sabe si el cliente compr√≥ una TV o un libro.</li>
                            <li style="margin-bottom: 0.8rem;"><strong>Precio pagado:</strong> No hay columnas de dinero aqu√≠.</li>
                            <li style="margin-bottom: 0.8rem;"><strong>Datos personales:</strong> Solo tiene IDs (como n√∫meros de ticket).</li>
                        </ul>

                        <h4 style="color: var(--primary); margin: 1.5rem 0 1rem;">¬øPara qu√© sirve entonces?</h4>
                        <p style="margin-bottom: 1rem;">Es el <strong>punto de partida</strong> de tu an√°lisis. Desde aqu√≠ haces JOIN con otras tablas para obtener:</p>
                        <ul style="margin-left: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;">Los productos (tabla <code>items</code>)</li>
                            <li style="margin-bottom: 0.8rem;">El dinero (tabla <code>payments</code>)</li>
                            <li style="margin-bottom: 0.8rem;">La ubicaci√≥n del cliente (tabla <code>customers</code> ‚Üí <code>geolocation</code>)</li>
                        </ul>

                        <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; margin-top: 1.5rem; border-left: 4px solid var(--primary);">
                            <strong>üí° Analog√≠a:</strong> Es como el recibo de un restaurante que solo dice "Mesa 5 - Comida - $0" sin detallar QU√â comiste.
                        </div>
                    `
                },
                importante: {
                    title: '‚ö†Ô∏è IMPORTANTE: NO SABE',
                    color: 'var(--rose)',
                    content: `
                        <h4 style="color: var(--rose); margin-bottom: 1rem;">¬øPor qu√© es tan importante esto?</h4>
                        <p style="margin-bottom: 1rem;"><strong>Muchos estudiantes cometen este error:</strong> Intentan sacar m√©tricas de ventas directamente de la tabla <code>orders</code>.</p>
                        
                        <div style="background: rgba(244, 63, 94, 0.1); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid var(--rose);">
                            <strong>‚ùå ERROR COM√öN:</strong>
                            <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; overflow-x: auto;">orders[orders['status'] == 'delivered'].shape[0]</pre>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;">Esto te da el N√öMERO de pedidos, pero no te dice cu√°nto dinero se gener√≥.</p>
                        </div>

                        <h4 style="color: var(--rose); margin: 1.5rem 0 1rem;">¬øQu√© necesitas hacer?</h4>
                        <p style="margin-bottom: 1rem;">Siempre debes hacer JOIN con otras tablas:</p>
                        <ul style="margin-left: 1.5rem; margin-bottom: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;"><strong>Para ver productos:</strong> JOIN con <code>olist_order_items</code></li>
                            <li style="margin-bottom: 0.8rem;"><strong>Para ver precios:</strong> JOIN con <code>olist_order_items</code> (columna <code>price</code>)</li>
                            <li style="margin-bottom: 0.8rem;"><strong>Para ver pagos:</strong> JOIN con <code>olist_order_payments</code></li>
                        </ul>

                        <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--emerald);">
                            <strong>‚úÖ CORRECTO:</strong>
                            <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; overflow-x: auto;"># Unir orders con items
result = pd.merge(orders, items, on='order_id')

# Filtrar solo delivered y sumar precios
result[result['status'] == 'delivered']['price'].sum()</pre>
                        </div>
                    `
                },
                regla: {
                    title: '‚≠ê Regla de Oro',
                    color: 'var(--amber)',
                    content: `
                        <h4 style="color: var(--amber); margin-bottom: 1rem;">¬øPor qu√© filtrar solo "delivered"?</h4>
                        <p style="margin-bottom: 1rem;">La tabla <code>orders</code> tiene una columna llamada <code>order_status</code> con varios valores posibles:</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid var(--emerald);">
                                <strong style="color: var(--emerald);">‚úÖ delivered</strong>
                                <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.9;">El cliente recibi√≥ su producto. <strong>Esto es una venta real.</strong></p>
                            </div>
                            <div style="background: rgba(244, 63, 94, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid var(--rose);">
                                <strong style="color: var(--rose);">‚ùå cancelled</strong>
                                <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.9;">El pedido fue cancelado. <strong>NO es una venta.</strong></p>
                            </div>
                            <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid var(--amber);">
                                <strong style="color: var(--amber);">‚ö†Ô∏è shipped</strong>
                                <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.9;">Est√° en camino, pero a√∫n no lleg√≥. <strong>Venta incierta.</strong></p>
                            </div>
                            <div style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid var(--secondary);">
                                <strong style="color: var(--secondary);">‚è≥ processing</strong>
                                <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.9;">A√∫n se est√° preparando. <strong>Venta pendiente.</strong></p>
                            </div>
                        </div>

                        <h4 style="color: var(--amber); margin: 1.5rem 0 1rem;">¬øQu√© pasa si NO filtras?</h4>
                        <div style="background: rgba(244, 63, 94, 0.1); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid var(--rose);">
                            <strong>Escenario de Error:</strong>
                            <p style="margin-top: 0.5rem;">Sin filtro: <code>orders.shape[0]</code> ‚Üí <strong>100,000 √≥rdenes</strong></p>
                            <p style="margin-top: 0.3rem;">Con filtro correcto: <code>orders[orders['status'] == 'delivered'].shape[0]</code> ‚Üí <strong>97,000 √≥rdenes</strong></p>
                            <p style="margin-top: 0.8rem; font-size: 0.95rem; color: var(--rose);"><strong>Diferencia:</strong> ¬°Le reportaste 3,000 ventas fantasma a tu jefe!</p>
                        </div>

                        <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--amber);">
                            <strong>üí° Regla Pr√°ctica:</strong>
                            <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; overflow-x: auto;"># Siempre filtra por delivered
orders_delivered = orders[orders['order_status'] == 'delivered']</pre>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;">Esto debe estar en TODAS tus consultas de an√°lisis de ventas.</p>
                        </div>
                    `
                },
                lifecycle: {
                    title: 'El Ciclo de Vida del Pedido - 5 Fechas Clave',
                    color: 'var(--emerald)',
                    content: `
                        <h4 style="color: var(--emerald); margin-bottom: 1rem;">¬øPor qu√© son importantes estas 5 fechas?</h4>
                        <p style="margin-bottom: 1.5rem;">Cada pedido en Olist pasa por <strong>5 momentos cr√≠ticos</strong> que quedan registrados con timestamps (fecha + hora exacta). Estas fechas son como los "checkpoints" de un videojuego: nos permiten saber d√≥nde est√° cada pedido y cu√°nto tiempo tard√≥ en cada etapa.</p>

                        <div style="display: grid; gap: 1rem; margin-bottom: 1.5rem;">
                            <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
                                <strong style="color: var(--primary);">üìÖ 1. Purchase (order_purchase_timestamp)</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.95rem;">El momento exacto en que el cliente hizo clic en "Comprar". Es el inicio de todo.</p>
                            </div>

                            <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--emerald);">
                                <strong style="color: var(--emerald);">‚úÖ 2. Approved (order_approved_at)</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.95rem;">Cuando el pago fue confirmado (tarjeta aprobada, boleto pagado, etc.). Ahora Olist puede procesar el pedido.</p>
                            </div>

                            <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--amber);">
                                <strong style="color: var(--amber);">üöö 3. Carrier (order_delivered_carrier_date)</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.95rem;">El producto fue entregado al transportista (Correos, DHL, etc.). Ya sali√≥ del almac√©n y est√° en camino.</p>
                            </div>

                            <div style="background: rgba(16, 185, 129, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--emerald); border: 2px solid var(--emerald);">
                                <strong style="color: var(--emerald);">üéâ 4. Customer (order_delivered_customer_date)</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.95rem;"><strong>¬°La m√°s importante!</strong> El cliente confirm√≥ que recibi√≥ su paquete. Esta es la fecha que usamos para calcular m√©tricas.</p>
                            </div>

                            <div style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--secondary);">
                                <strong style="color: var(--secondary);">‚è∞ 5. Estimated (order_estimated_delivery_date)</strong>
                                <p style="margin-top: 0.5rem; font-size: 0.95rem;">La fecha que Olist <em>prometi√≥</em> al cliente. Es la "promesa de entrega" que se mostr√≥ al momento de la compra.</p>
                            </div>
                        </div>

                        <h4 style="color: var(--emerald); margin: 1.5rem 0 1rem;">¬øC√≥mo usamos estas fechas en an√°lisis?</h4>
                        <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--emerald);">
                            <strong>Ejemplo: Calcular tiempo total de entrega</strong>
                            <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; overflow-x: auto; font-size: 0.9rem;"># En pandas:
orders['delivery_time'] = (orders['order_delivered_customer_date'] - 
                           orders['order_purchase_timestamp']).dt.days

# Esto nos da cu√°ntos d√≠as pasaron desde la compra hasta la entrega</pre>
                        </div>

                        <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 8px; margin-top: 1rem; border-left: 4px solid var(--amber);">
                            <strong>üí° Tip importante:</strong> Algunas fechas pueden ser NULL (vac√≠as). Por ejemplo, si un pedido fue cancelado, no tendr√° <code>order_delivered_customer_date</code> porque nunca lleg√≥ al cliente.
                        </div>
                    `
                },
                kpis: {
                    title: 'KPIs de Experiencia del Cliente',
                    color: 'var(--emerald)',
                    content: `
                        <h4 style="color: var(--emerald); margin-bottom: 1rem;">¬øQu√© son estos KPIs y por qu√© los calculamos?</h4>
                        <p style="margin-bottom: 1.5rem;">Estos indicadores nos permiten <strong>medir la satisfacci√≥n del cliente</strong> de forma objetiva. No preguntamos "¬øEst√°s feliz?", sino que medimos hechos: "¬øCumplimos nuestra promesa?" y "¬øCu√°nto tiempo esperaste realmente?"</p>

                        <h4 style="color: var(--primary); margin: 1.5rem 0 1rem;">üìä KPI 1: Demora Real (Real Wait Time)</h4>
                        <div style="background: rgba(59, 130, 246, 0.1); padding: 1.2rem; border-radius: 8px; border-left: 4px solid var(--primary); margin-bottom: 1.5rem;">
                            <div style="font-family: monospace; font-size: 1.1rem; margin-bottom: 1rem; color: var(--primary);">
                                <strong>delivered - purchase</strong>
                            </div>
                            
                            <h5 style="margin-bottom: 0.8rem;">¬øQu√© mide exactamente?</h5>
                            <p style="margin-bottom: 1rem; line-height: 1.6;">
                                El <strong>tiempo total</strong> desde que el cliente hizo clic en "Comprar" hasta que recibi√≥ f√≠sicamente su producto. 
                                Es la experiencia real del cliente, sin importar lo que Olist prometi√≥.
                            </p>

                            <h5 style="margin-bottom: 0.8rem;">¬øPor qu√© es importante?</h5>
                            <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                                <li style="margin-bottom: 0.5rem;">Nos dice si el proceso log√≠stico es <strong>r√°pido o lento</strong></li>
                                <li style="margin-bottom: 0.5rem;">Identifica cuellos de botella (¬øtarda mucho en aprobar? ¬øen enviar?)</li>
                                <li style="margin-bottom: 0.5rem;">Permite comparar entre regiones: ¬øS√£o Paulo recibe m√°s r√°pido que Manaus?</li>
                            </ul>

                            <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 6px;">
                                <strong>Ejemplo pr√°ctico:</strong>
                                <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; font-size: 0.9rem;"># Calcular demora promedio
orders['demora_real'] = (orders['delivered'] - orders['purchase']).dt.days
promedio = orders['demora_real'].mean()

print(f"En promedio, los clientes esperan {promedio:.1f} d√≠as")</pre>
                            </div>
                        </div>

                        <h4 style="color: var(--amber); margin: 1.5rem 0 1rem;">‚è±Ô∏è KPI 2: Delay / Retraso (Promise Fulfillment)</h4>
                        <div style="background: rgba(245, 158, 11, 0.1); padding: 1.2rem; border-radius: 8px; border-left: 4px solid var(--amber);">
                            <div style="font-family: monospace; font-size: 1.1rem; margin-bottom: 1rem; color: var(--amber);">
                                <strong>delivered - estimated</strong>
                            </div>
                            
                            <h5 style="margin-bottom: 0.8rem;">¬øQu√© mide exactamente?</h5>
                            <p style="margin-bottom: 1rem; line-height: 1.6;">
                                Si Olist <strong>cumpli√≥ su promesa de entrega</strong>. Compara cu√°ndo lleg√≥ el producto vs. cu√°ndo se prometi√≥ que llegar√≠a.
                            </p>

                            <h5 style="margin-bottom: 0.8rem;">¬øC√≥mo interpretarlo?</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
                                <div style="background: rgba(244, 63, 94, 0.15); padding: 1rem; border-radius: 6px; border: 1px solid var(--rose);">
                                    <strong style="color: var(--rose);">üìà N√∫mero POSITIVO</strong>
                                    <p style="margin-top: 0.5rem; font-size: 0.9rem;">
                                        Lleg√≥ <strong>tarde</strong>. Cliente probablemente molesto.
                                        <br><br>
                                        <code>+3 d√≠as</code> = Lleg√≥ 3 d√≠as despu√©s de lo prometido
                                    </p>
                                </div>
                                <div style="background: rgba(16, 185, 129, 0.15); padding: 1rem; border-radius: 6px; border: 1px solid var(--emerald);">
                                    <strong style="color: var(--emerald);">üìâ N√∫mero NEGATIVO</strong>
                                    <p style="margin-top: 0.5rem; font-size: 0.9rem;">
                                        Lleg√≥ <strong>antes</strong>. Cliente feliz y sorprendido.
                                        <br><br>
                                        <code>-2 d√≠as</code> = Lleg√≥ 2 d√≠as antes de lo prometido
                                    </p>
                                </div>
                            </div>

                            <div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 6px; margin-top: 1rem;">
                                <strong>Ejemplo de an√°lisis:</strong>
                                <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; font-size: 0.9rem;"># Calcular delay
orders['delay'] = (orders['delivered'] - orders['estimated']).dt.days

# ¬øCu√°ntos llegaron tarde?
late = (orders['delay'] > 0).sum()
early = (orders['delay'] < 0).sum()

print(f"Llegaron tarde: {late} pedidos")
print(f"Llegaron antes: {early} pedidos (¬°bien!)")</pre>
                            </div>
                        </div>

                        <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; margin-top: 1.5rem; border-left: 4px solid var(--primary);">
                            <strong>üí° Insight clave:</strong> Un "Delay" promedio de <code>0</code> no significa perfecci√≥n. Puede haber muchos pedidos que llegaron muy tarde (+10 d√≠as) compensados por otros que llegaron muy temprano (-10 d√≠as). Siempre revisa la <strong>distribuci√≥n</strong>, no solo el promedio.
                        </div>
                    `
                }
            };


            const concept = concepts[conceptId];
            if (concept && modal && title && content) {
                title.innerHTML = concept.title;
                title.style.color = concept.color;
                content.innerHTML = concept.content;
                modal.classList.add('active');
            }
        }

        // Pandas Command Modal Logic
        function openPandasModal(commandId) {
            const modal = document.getElementById('modal-pandas');
            const title = document.getElementById('pandas-title');
            const content = document.getElementById('pandas-content');

            const commands = {
                select: {
                    title: 'Seleccionar Columnas',
                    color: 'var(--primary)',
                    content: `
                        <h4 style="color: var(--primary); margin-bottom: 1rem;">¬øC√≥mo seleccionar columnas?</h4>
                        <pre style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; margin-bottom: 1rem; overflow-x: auto;"># Una sola columna (devuelve Series)
items['product_id']

# M√∫ltiples columnas (devuelve DataFrame)
items[['product_id', 'price']]</pre>

                        <h4 style="color: var(--primary); margin: 1.5rem 0 1rem;">Ejemplo pr√°ctico con Olist:</h4>
                        <pre style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; overflow-x: auto;"># Solo ver IDs y precios
productos = items[['order_id', 'product_id', 'price']]
productos.head()</pre>

                        <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; margin-top: 1.5rem; border-left: 4px solid var(--primary);">
                            <strong>üí° Tip:</strong> Usa <strong>doble corchete [[]]</strong> para m√∫ltiples columnas, single <strong>[]</strong> para una sola.
                        </div>
                    `
                },
                filter: {
                    title: 'Filtrar Filas',
                    color: 'var(--amber)',
                    content: `
                        <h4 style="color: var(--amber); margin-bottom: 1rem;">¬øC√≥mo filtrar datos?</h4>
                        <pre style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; margin-bottom: 1rem; overflow-x: auto;"># Condici√≥n simple
delivered = orders[orders['order_status'] == 'delivered']

# M√∫ltiples condiciones (AND)
recientes = orders[(orders['order_status'] == 'delivered') & 
                    (orders['order_purchase_timestamp'] > '2018-01-01')]

# M√∫ltiples condiciones (OR)
problematicos = orders[(orders['order_status'] == 'cancelled') | 
                        (orders['order_status'] == 'unavailable')]</pre>

                        <h4 style="color: var(--amber); margin: 1.5rem 0 1rem;">Operadores comunes:</h4>
                        <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                            <li style="margin-bottom: 0.5rem;"><code>==</code> igual a</li>
                            <li style="margin-bottom: 0.5rem;"><code>!=</code> diferente de</li>
                            <li style="margin-bottom: 0.5rem;"><code>></code>, <code><</code>, <code>>=</code>, <code><=</code> comparaciones num√©ricas</li>
                            <li style="margin-bottom: 0.5rem;"><code>&</code> AND l√≥gico</li>
                            <li style="margin-bottom: 0.5rem;"><code>|</code> OR l√≥gico</li>
                        </ul>

                        <div style="background: rgba(245, 158, 11, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--amber);">
                            <strong>‚ö†Ô∏è Importante:</strong> Usa <code>&</code> y <code>|</code> (no <code>and</code>/<code>or</code>) y siempre encierra condiciones en par√©ntesis.
                        </div>
                    `
                },
                merge: {
                    title: 'Unir DataFrames (JOIN)',
                    color: 'var(--emerald)',
                    content: `
                        <h4 style="color: var(--emerald); margin-bottom: 1rem;">pd.merge() - El pegamento de pandas</h4>
                        <pre style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; margin-bottom: 1rem; overflow-x: auto;"># INNER JOIN (solo coincidencias)
result = pd.merge(orders, items, on='order_id', how='inner')

# LEFT JOIN (todas las filas de orders)
result = pd.merge(orders, items, on='order_id', how='left')

# Columnas con nombres diferentes
result = pd.merge(df1, df2, left_on='col_a', right_on='col_b')</pre>

                        <h4 style="color: var(--emerald); margin: 1.5rem 0 1rem;">Tipos de JOIN:</h4>
                        <div style="display: grid; gap: 0.8rem; margin-bottom: 1.5rem;">
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 0.8rem; border-radius: 6px; border-left: 3px solid var(--emerald);">
                                <strong>inner:</strong> Solo filas con coincidencias en ambas tablas
                            </div>
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 0.8rem; border-radius: 6px; border-left: 3px solid var(--emerald);">
                                <strong>left:</strong> Todas las filas de la izquierda + coincidencias
                            </div>
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 0.8rem; border-radius: 6px; border-left: 3px solid var(--emerald);">
                                <strong>right:</strong> Todas las filas de la derecha + coincidencias
                            </div>
                            <div style="background: rgba(16, 185, 129, 0.1); padding: 0.8rem; border-radius: 6px; border-left: 3px solid var(--emerald);">
                                <strong>outer:</strong> Todas las filas de ambas tablas
                            </div>
                        </div>

                        <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--emerald);">
                            <strong>‚úÖ Ejemplo Olist:</strong>
                            <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; overflow-x: auto;"># Unir orders con items para ver productos
full_data = pd.merge(orders, items, on='order_id')
print(f"Orders: {len(orders)}, Items: {len(items)}, Resultado: {len(full_data)}")</pre>
                        </div>
                    `
                },
                groupby: {
                    title: 'Agrupar y Agregar (.groupby)',
                    color: 'var(--secondary)',
                    content: `
                        <h4 style="color: var(--secondary); margin-bottom: 1rem;">¬øPara qu√© sirve groupby()?</h4>
                        <p style="margin-bottom: 1rem;">Agrupa filas con valores id√©nticos y aplica funciones de agregaci√≥n (suma, promedio, conteo, etc.).</p>

                        <pre style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; margin-bottom: 1rem; overflow-x: auto;"># Contar clientes por estado
customers.groupby('customer_state')['customer_id'].count()

# Ventas totales por categor√≠a
items.groupby('product_category')['price'].sum()

# M√∫ltiples agregaciones
items.groupby('seller_id').agg({
    'price': ['sum', 'mean', 'count'],
    'freight_value': 'sum'
})</pre>

                        <h4 style="color: var(--secondary); margin: 1.5rem 0 1rem;">Funciones de agregaci√≥n comunes:</h4>
                        <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                            <li style="margin-bottom: 0.5rem;"><code>.count()</code> - Contar filas</li>
                            <li style="margin-bottom: 0.5rem;"><code>.sum()</code> - Sumar valores</li>
                            <li style="margin-bottom: 0.5rem;"><code>.mean()</code> - Promedio</li>
                            <li style="margin-bottom: 0.5rem;"><code>.min()</code> / <code>.max()</code> - M√≠nimo/M√°ximo</li>
                            <li style="margin-bottom: 0.5rem;"><code>.agg()</code> - M√∫ltiples agregaciones</li>
                        </ul>

                        <div style="background: rgba(139, 92, 246, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--secondary);">
                            <strong>üìä Ejemplo Olist - Top 5 estados con m√°s clientes:</strong>
                            <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; overflow-x: auto;">top_states = customers.groupby('customer_state')['customer_id'].count().sort_values(ascending=False).head(5)
print(top_states)</pre>
                        </div>
                    `
                },
                sort: {
                    title: 'Ordenar (.sort_values)',
                    color: 'var(--rose)',
                    content: `
                        <h4 style="color: var(--rose); margin-bottom: 1rem;">¬øC√≥mo ordenar un DataFrame?</h4>
                        <pre style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; margin-bottom: 1rem; overflow-x: auto;"># Ordenar por una columna (menor a mayor)
items_sorted = items.sort_values(by='price')

# Ordenar descendente (mayor a menor)
items_sorted = items.sort_values(by='price', ascending=False)

# Ordenar por m√∫ltiples columnas
items_sorted = items.sort_values(by=['seller_id', 'price'], 
                                   ascending=[True, False])</pre>

                        <h4 style="color: var(--rose); margin: 1.5rem 0 1rem;">Par√°metros √∫tiles:</h4>
                        <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                            <li style="margin-bottom: 0.5rem;"><code>by</code> - Columna(s) para ordenar</li>
                            <li style="margin-bottom: 0.5rem;"><code>ascending</code> - True (menor a mayor) o False (mayor a menor)</li>
                            <li style="margin-bottom: 0.5rem;"><code>inplace</code> - Si True, modifica el DataFrame original</li>
                        </ul>

                        <div style="background: rgba(244, 63, 94, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--rose);">
                            <strong>üî• Ejemplo Olist - Productos m√°s caros:</strong>
                            <pre style="margin-top: 0.5rem; background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 4px; overflow-x: auto;">top_expensive = items.sort_values(by='price', ascending=False).head(10)
top_expensive[['product_id', 'price']]</pre>
                        </div>
                    `
                },
                head: {
                    title: 'Ver Primeras Filas (.head)',
                    color: '#06b6d4',
                    content: `
                        <h4 style="color: #06b6d4; margin-bottom: 1rem;">¬øPara qu√© sirve .head()?</h4>
                        <p style="margin-bottom: 1rem;">Muestra las primeras N filas de un DataFrame. Ideal para "echar un vistazo" r√°pido.</p>

                        <pre style="background: rgba(0,0,0,0.3); padding: 0.8rem; border-radius: 6px; margin-bottom: 1rem; overflow-x: auto;"># Por defecto muestra 5 filas
orders.head()

# Especificar cantidad
orders.head(10)

# Ver las √∫ltimas filas
orders.tail(10)</pre>

                        <h4 style="color: #06b6d4; margin: 1.5rem 0 1rem;">Comandos relacionados:</h4>
                        <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
                            <li style="margin-bottom: 0.5rem;"><code>. head(n)</code> - Primeras N filas</li>
                            <li style="margin-bottom: 0.5rem;"><code>.tail(n)</code> - √öltimas N filas</li>
                            <li style="margin-bottom: 0.5rem;"><code>.sample(n)</code> - N filas aleatorias</li>
                            <li style="margin-bottom: 0.5rem;"><code>.info()</code> - Informaci√≥n del DataFrame</li>
                            <li style="margin-bottom: 0.5rem;"><code>.describe()</code> - Estad√≠sticas descriptivas</li>
                        </ul>

                        <div style="background: rgba(6, 182, 212, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #06b6d4;">
                            <strong>üí° Tip:</strong> Siempre usa <code>.head()</code> despu√©s de hacer cambios para verificar que todo se vea bien antes de procesar todo el dataset.
                        </div>
                    `
                }
            };

            const command = commands[commandId];
            if (command && modal && title && content) {
                title.innerHTML = command.title;
                title.style.color = command.color;
                content.innerHTML = command.content;
                modal.classList.add('active');
            }
        }

        // Navigation
        function updateSlide() {
            slides.forEach((slide, index) => {
                if (index === currentSlide) slide.classList.add('active');
                else slide.classList.remove('active');
            });
            const progress = ((currentSlide + 1) / slides.length) * 100;
            progressBar.style.width = progress + '%';
        }

        function nextSlide() {
            if (currentSlide < slides.length - 1) {
                currentSlide++;
                updateSlide();
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlide();
            }
        }

        document.addEventListener('keydown', (e) => {
            if (['ArrowRight', 'Space'].includes(e.code)) nextSlide();
            if (['ArrowLeft'].includes(e.code)) prevSlide();
            if (e.key === 'Escape') closeModal(null, true);

            // F2 to toggle fullscreen
            if (e.key === 'F2') {
                e.preventDefault();
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.log(`Error attempting to enable fullscreen: ${err.message}`);
                    });
                } else {
                    document.exitFullscreen();
                }
            }
        });


        // Loop animation for Nodes
        setInterval(() => {
            const nodes = document.querySelectorAll('.node:not(.center)');
            const random = Math.floor(Math.random() * nodes.length);
            nodes[random].style.transform = 'scale(1.1)';
            setTimeout(() => {
                nodes[random].style.transform = 'scale(1)';
            }, 500);
        }, 2000);

        updateSlide();
    </script>
</body>

</html>